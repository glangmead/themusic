/* esm.sh - butterchurn@2.6.7 */
var _e=Object.create;var fe=Object.defineProperty;var Re=Object.getOwnPropertyDescriptor;var Le=Object.getOwnPropertyNames;var Ue=Object.getPrototypeOf,Me=Object.prototype.hasOwnProperty;var ye=(S,M)=>()=>(M||S((M={exports:{}}).exports,M),M.exports);var we=(S,M,c,x)=>{if(M&&typeof M=="object"||typeof M=="function")for(let _ of Le(M))!Me.call(S,_)&&_!==c&&fe(S,_,{get:()=>M[_],enumerable:!(x=Re(M,_))||x.enumerable});return S};var Be=(S,M,c)=>(c=S!=null?_e(Ue(S)):{},we(M||!S||!S.__esModule?fe(c,"default",{value:S,enumerable:!0}):c,S));var ge=ye((Kt,Vt)=>{(function(M,c){typeof Kt=="object"&&typeof Vt=="object"?Vt.exports=c():typeof define=="function"&&define.amd?define("butterchurn",[],c):typeof Kt=="object"?Kt.butterchurn=c():M.butterchurn=c()})(window,function(){return(function(S){var M={};function c(x){if(M[x])return M[x].exports;var _=M[x]={i:x,l:!1,exports:{}};return S[x].call(_.exports,_,_.exports,c),_.l=!0,_.exports}return c.m=S,c.c=M,c.d=function(x,_,p){c.o(x,_)||Object.defineProperty(x,_,{enumerable:!0,get:p})},c.r=function(x){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})},c.t=function(x,_){if(_&1&&(x=c(x)),_&8||_&4&&typeof x=="object"&&x&&x.__esModule)return x;var p=Object.create(null);if(c.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:x}),_&2&&typeof x!="string")for(var T in x)c.d(p,T,function(u){return x[u]}.bind(null,T));return p},c.n=function(x){var _=x&&x.__esModule?function(){return x.default}:function(){return x};return c.d(_,"a",_),_},c.o=function(x,_){return Object.prototype.hasOwnProperty.call(x,_)},c.p="",c(c.s="./src/index.js")})({"./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js":(function(S,M,c){"use strict";{let x=(p,T)=>{var u=typeof T=="function",h=typeof T=="function",e=typeof T=="function";Object.defineProperty(Math,p,{configurable:u,enumerable:e,writable:h,value:T})};x("DEG_PER_RAD",Math.PI/180),x("RAD_PER_DEG",180/Math.PI);let _=new Float32Array(1);x("scale",function(T,u,h,e,t){return arguments.length===0?NaN:Number.isNaN(T)||Number.isNaN(u)||Number.isNaN(h)||Number.isNaN(e)||Number.isNaN(t)?NaN:T===1/0||T===-1/0?T:(T-u)*(t-e)/(h-u)+e}),x("fscale",function(T,u,h,e,t){return _[0]=Math.scale(T,u,h,e,t),_[0]}),x("clamp",function(T,u,h){return Math.min(h,Math.max(u,T))}),x("radians",function(T){return T*Math.DEG_PER_RAD}),x("degrees",function(T){return T*Math.RAD_PER_DEG})}}),"./src/audio/audioLevels.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return T});function x(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function _(u,h){for(var e=0;e<h.length;e++){var t=h[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(u,t.key,t)}}function p(u,h,e){return h&&_(u.prototype,h),e&&_(u,e),u}var T=(function(){function u(h){x(this,u),this.audio=h;var e;this.audio.audioContext?e=this.audio.audioContext.sampleRate:e=44100;var t=e/this.audio.fftSize,i=Math.clamp(Math.round(20/t)-1,0,this.audio.numSamps-1),s=Math.clamp(Math.round(320/t)-1,0,this.audio.numSamps-1),a=Math.clamp(Math.round(2800/t)-1,0,this.audio.numSamps-1),l=Math.clamp(Math.round(11025/t)-1,0,this.audio.numSamps-1);this.starts=[i,s,a],this.stops=[s,a,l],this.val=new Float32Array(3),this.imm=new Float32Array(3),this.att=new Float32Array(3),this.avg=new Float32Array(3),this.longAvg=new Float32Array(3),this.att.fill(1),this.avg.fill(1),this.longAvg.fill(1)}return p(u,[{key:"updateAudioLevels",value:function(e,t){if(this.audio.freqArray.length>0){var i=e;!u.isFiniteNumber(i)||i<15?i=15:i>144&&(i=144),this.imm.fill(0);for(var s=0;s<3;s++)for(var a=this.starts[s];a<this.stops[s];a++)this.imm[s]+=this.audio.freqArray[a];for(var l=0;l<3;l++){var n=void 0;this.imm[l]>this.avg[l]?n=.2:n=.5,n=u.adjustRateToFPS(n,30,i),this.avg[l]=this.avg[l]*n+this.imm[l]*(1-n),t<50?n=.9:n=.992,n=u.adjustRateToFPS(n,30,i),this.longAvg[l]=this.longAvg[l]*n+this.imm[l]*(1-n),this.longAvg[l]<.001?(this.val[l]=1,this.att[l]=1):(this.val[l]=this.imm[l]/this.longAvg[l],this.att[l]=this.avg[l]/this.longAvg[l])}}}},{key:"bass",get:function(){return this.val[0]}},{key:"bass_att",get:function(){return this.att[0]}},{key:"mid",get:function(){return this.val[1]}},{key:"mid_att",get:function(){return this.att[1]}},{key:"treb",get:function(){return this.val[2]}},{key:"treb_att",get:function(){return this.att[2]}}],[{key:"isFiniteNumber",value:function(e){return Number.isFinite(e)&&!Number.isNaN(e)}},{key:"adjustRateToFPS",value:function(e,t,i){return Math.pow(e,t/i)}}]),u})()}),"./src/audio/audioProcessor.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/audio/fft.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e){_(this,h),this.numSamps=512,this.fftSize=this.numSamps*2,this.fft=new x.default(this.fftSize,512,!0),e&&(this.audioContext=e,this.audible=e.createDelay(),this.analyser=e.createAnalyser(),this.analyser.smoothingTimeConstant=0,this.analyser.fftSize=this.fftSize,this.audible.connect(this.analyser),this.analyserL=e.createAnalyser(),this.analyserL.smoothingTimeConstant=0,this.analyserL.fftSize=this.fftSize,this.analyserR=e.createAnalyser(),this.analyserR.smoothingTimeConstant=0,this.analyserR.fftSize=this.fftSize,this.splitter=e.createChannelSplitter(2),this.audible.connect(this.splitter),this.splitter.connect(this.analyserL,0),this.splitter.connect(this.analyserR,1)),this.timeByteArray=new Uint8Array(this.fftSize),this.timeByteArrayL=new Uint8Array(this.fftSize),this.timeByteArrayR=new Uint8Array(this.fftSize),this.timeArray=new Int8Array(this.fftSize),this.timeByteArraySignedL=new Int8Array(this.fftSize),this.timeByteArraySignedR=new Int8Array(this.fftSize),this.tempTimeArrayL=new Int8Array(this.fftSize),this.tempTimeArrayR=new Int8Array(this.fftSize),this.timeArrayL=new Int8Array(this.numSamps),this.timeArrayR=new Int8Array(this.numSamps)}return T(h,[{key:"sampleAudio",value:function(){this.analyser.getByteTimeDomainData(this.timeByteArray),this.analyserL.getByteTimeDomainData(this.timeByteArrayL),this.analyserR.getByteTimeDomainData(this.timeByteArrayR),this.processAudio()}},{key:"updateAudio",value:function(t,i,s){this.timeByteArray.set(t),this.timeByteArrayL.set(i),this.timeByteArrayR.set(s),this.processAudio()}},{key:"processAudio",value:function(){for(var t=0,i=0,s=0;t<this.fftSize;t++)this.timeArray[t]=this.timeByteArray[t]-128,this.timeByteArraySignedL[t]=this.timeByteArrayL[t]-128,this.timeByteArraySignedR[t]=this.timeByteArrayR[t]-128,this.tempTimeArrayL[t]=.5*(this.timeByteArraySignedL[t]+this.timeByteArraySignedL[s]),this.tempTimeArrayR[t]=.5*(this.timeByteArraySignedR[t]+this.timeByteArraySignedR[s]),t%2===0&&(this.timeArrayL[i]=this.tempTimeArrayL[t],this.timeArrayR[i]=this.tempTimeArrayR[t],i+=1),s=t;this.freqArray=this.fft.timeToFrequencyDomain(this.timeArray),this.freqArrayL=this.fft.timeToFrequencyDomain(this.timeByteArraySignedL),this.freqArrayR=this.fft.timeToFrequencyDomain(this.timeByteArraySignedR)}},{key:"connectAudio",value:function(t){t.connect(this.audible)}},{key:"disconnectAudio",value:function(t){t.disconnect(this.audible)}}]),h})()}),"./src/audio/fft.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return T});function x(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function _(u,h){for(var e=0;e<h.length;e++){var t=h[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(u,t.key,t)}}function p(u,h,e){return h&&_(u.prototype,h),e&&_(u,e),u}var T=(function(){function u(h,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;x(this,u),this.samplesIn=h,this.samplesOut=e,this.equalize=t,this.NFREQ=e*2,this.equalize&&this.initEqualizeTable(),this.initBitRevTable(),this.initCosSinTable()}return p(u,[{key:"initEqualizeTable",value:function(){this.equalizeArr=new Float32Array(this.samplesOut);for(var e=1/this.samplesOut,t=0;t<this.samplesOut;t++)this.equalizeArr[t]=-.02*Math.log((this.samplesOut-t)*e)}},{key:"initBitRevTable",value:function(){this.bitrevtable=new Uint16Array(this.NFREQ);for(var e=0;e<this.NFREQ;e++)this.bitrevtable[e]=e;for(var t=0,i=0;i<this.NFREQ;i++){if(t>i){var s=this.bitrevtable[i];this.bitrevtable[i]=this.bitrevtable[t],this.bitrevtable[t]=s}for(var a=this.NFREQ>>1;a>=1&&t>=a;)t-=a,a>>=1;t+=a}}},{key:"initCosSinTable",value:function(){for(var e=2,t=0;e<=this.NFREQ;)t+=1,e<<=1;this.cossintable=[new Float32Array(t),new Float32Array(t)],e=2;for(var i=0;e<=this.NFREQ;){var s=-2*Math.PI/e;this.cossintable[0][i]=Math.cos(s),this.cossintable[1][i]=Math.sin(s),i+=1,e<<=1}}},{key:"timeToFrequencyDomain",value:function(e){for(var t=new Float32Array(this.NFREQ),i=new Float32Array(this.NFREQ),s=0;s<this.NFREQ;s++){var a=this.bitrevtable[s];a<this.samplesIn?t[s]=e[a]:t[s]=0,i[s]=0}for(var l=2,n=0;l<=this.NFREQ;){for(var o=this.cossintable[0][n],r=this.cossintable[1][n],d=1,P=0,E=l>>1,v=0;v<E;v++){for(var b=v;b<this.NFREQ;b+=l){var U=b+E,D=d*t[U]-P*i[U],C=d*i[U]+P*t[U];t[U]=t[b]-D,i[U]=i[b]-C,t[b]+=D,i[b]+=C}var w=d;d=w*o-P*r,P=P*o+w*r}l<<=1,n+=1}var L=new Float32Array(this.samplesOut);if(this.equalize)for(var A=0;A<this.samplesOut;A++)L[A]=this.equalizeArr[A]*Math.sqrt(t[A]*t[A]+i[A]*i[A]);else for(var f=0;f<this.samplesOut;f++)L[f]=Math.sqrt(t[f]*t[f]+i[f]*i[f]);return L}}]),u})()}),"./src/blankPreset.js":(function(S,M,c){var x,_;x=[],_=(function(){"use strict;";var p={baseVals:{gammaadj:1.25,wave_g:.5,mv_x:12,warpscale:1,brighten:0,mv_y:9,wave_scale:1,echo_alpha:0,additivewave:0,sx:1,sy:1,warp:.01,red_blue:0,wave_mode:0,wave_brighten:0,wrap:0,zoomexp:1,fshader:0,wave_r:.5,echo_zoom:1,wave_smoothing:.75,warpanimspeed:1,wave_dots:0,wave_x:.5,wave_y:.5,zoom:1,solarize:0,modwavealphabyvolume:0,dx:0,cx:.5,dy:0,darken_center:0,cy:.5,invert:0,bmotionvectorson:0,rot:0,modwavealphaend:.95,wave_mystery:-.2,decay:.9,wave_a:1,wave_b:.5,rating:5,modwavealphastart:.75,darken:0,echo_orient:0,ib_r:.5,ib_g:.5,ib_b:.5,ib_a:0,ib_size:0,ob_r:.5,ob_g:.5,ob_b:.5,ob_a:0,ob_size:0,mv_dx:0,mv_dy:0,mv_a:0,mv_r:.5,mv_g:.5,mv_b:.5,mv_l:0},init_eqs:function(){var u={};return u},frame_eqs:function(u){return u.rkeys=["warp"],u.zoom=1.01+.02*u.treb_att,u.warp=.15+.25*u.bass_att,u},pixel_eqs:function(u){return u.warp=u.warp+u.rad*.15,u},waves:[{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(u){return u.rkeys=[],u},frame_eqs:function(u){return u},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(u){return u.rkeys=[],u},frame_eqs:function(u){return u},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(u){return u.rkeys=[],u},frame_eqs:function(u){return u},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(u){return u.rkeys=[],u},frame_eqs:function(u){return u},point_eqs:""}],shapes:[{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(u){return u.rkeys=[],u},frame_eqs:function(u){return u}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(u){return u.rkeys=[],u},frame_eqs:function(u){return u}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(u){return u.rkeys=[],u},frame_eqs:function(u){return u}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(u){return u.rkeys=[],u},frame_eqs:function(u){return u}}],warp:`shader_body {
ret = texture2D(sampler_main, uv).rgb;
ret -= 0.004;
}
`,comp:`shader_body {
ret = texture2D(sampler_main, uv).rgb;
ret *= hue_shader;
}
`};return p}).apply(M,x),_!==void 0&&(S.exports=_)}),"./src/equations/presetEquationRunner.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/utils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e,t,i){_(this,h),this.preset=e,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=x.default.range(1,33).map(function(s){return"q".concat(s)}),this.ts=x.default.range(1,9).map(function(s){return"t".concat(s)}),this.regs=x.default.range(100).map(function(s){return s<10?"reg0".concat(s):"reg".concat(s)}),this.initializeEquations(t)}return T(h,[{key:"initializeEquations",value:function(t){this.runVertEQs=this.preset.pixel_eqs!=="",this.mdVSQInit=null,this.mdVSRegs=null,this.mdVSFrame=null,this.mdVSUserKeys=null,this.mdVSFrameMap=null,this.mdVSShapes=null,this.mdVSUserKeysShapes=null,this.mdVSFrameMapShapes=null,this.mdVSWaves=null,this.mdVSUserKeysWaves=null,this.mdVSFrameMapWaves=null,this.mdVSQAfterFrame=null,this.gmegabuf=new Array(1048576).fill(0);var i={frame:t.frame,time:t.time,fps:t.fps,bass:t.bass,bass_att:t.bass_att,mid:t.mid,mid_att:t.mid_att,treb:t.treb,treb_att:t.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY,gmegabuf:this.gmegabuf};this.mdVS=Object.assign({},this.preset.baseVals,i),this.mdVS.megabuf=new Array(1048576).fill(0),this.mdVS.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.mdVS.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]);var s=this.qs.concat(this.regs,Object.keys(this.mdVS)),a=this.preset.init_eqs(x.default.cloneVars(this.mdVS));this.mdVSQInit=x.default.pick(a,this.qs),this.mdVSRegs=x.default.pick(a,this.regs);var l=x.default.pick(a,Object.keys(x.default.omit(a,s)));if(l.megabuf=a.megabuf,l.gmegabuf=a.gmegabuf,this.mdVSFrame=this.preset.frame_eqs(Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSRegs,l)),this.mdVSUserKeys=Object.keys(x.default.omit(this.mdVSFrame,s)),this.mdVSFrameMap=x.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=x.default.pick(this.mdVSFrame,this.qs),this.mdVSRegs=x.default.pick(this.mdVSFrame,this.regs),this.mdVSWaves=[],this.mdVSTWaveInits=[],this.mdVSUserKeysWaves=[],this.mdVSFrameMapWaves=[],this.preset.waves&&this.preset.waves.length>0)for(var n=0;n<this.preset.waves.length;n++){var o=this.preset.waves[n],r=o.baseVals;if(r.enabled!==0){var d=Object.assign({},r,i),P=this.qs.concat(this.ts,this.regs,Object.keys(d));Object.assign(d,this.mdVSQAfterFrame,this.mdVSRegs),d.megabuf=new Array(1048576).fill(0),o.init_eqs&&(d=o.init_eqs(d),this.mdVSRegs=x.default.pick(d,this.regs),Object.assign(d,r)),this.mdVSWaves.push(d),this.mdVSTWaveInits.push(x.default.pick(d,this.ts)),this.mdVSUserKeysWaves.push(Object.keys(x.default.omit(d,P))),this.mdVSFrameMapWaves.push(x.default.pick(d,this.mdVSUserKeysWaves[n]))}else this.mdVSWaves.push({}),this.mdVSTWaveInits.push({}),this.mdVSUserKeysWaves.push([]),this.mdVSFrameMapWaves.push({})}if(this.mdVSShapes=[],this.mdVSTShapeInits=[],this.mdVSUserKeysShapes=[],this.mdVSFrameMapShapes=[],this.preset.shapes&&this.preset.shapes.length>0)for(var E=0;E<this.preset.shapes.length;E++){var v=this.preset.shapes[E],b=v.baseVals;if(b.enabled!==0){var U=Object.assign({},b,i),D=this.qs.concat(this.ts,this.regs,Object.keys(U));Object.assign(U,this.mdVSQAfterFrame,this.mdVSRegs),U.megabuf=new Array(1048576).fill(0),v.init_eqs&&(U=v.init_eqs(U),this.mdVSRegs=x.default.pick(U,this.regs),Object.assign(U,b)),this.mdVSShapes.push(U),this.mdVSTShapeInits.push(x.default.pick(U,this.ts)),this.mdVSUserKeysShapes.push(Object.keys(x.default.omit(U,D))),this.mdVSFrameMapShapes.push(x.default.pick(U,this.mdVSUserKeysShapes[E]))}else this.mdVSShapes.push({}),this.mdVSTShapeInits.push({}),this.mdVSUserKeysShapes.push([]),this.mdVSFrameMapShapes.push({})}}},{key:"updatePreset",value:function(t,i){this.preset=t,this.initializeEquations(i)}},{key:"updateGlobals",value:function(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}},{key:"runFrameEquations",value:function(t){this.mdVSFrame=Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSFrameMap,t),this.mdVSFrame=this.preset.frame_eqs(this.mdVSFrame),this.mdVSFrameMap=x.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=x.default.pick(this.mdVSFrame,this.qs)}}]),h})()}),"./src/image/imageTextures.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return T});function x(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function _(u,h){for(var e=0;e<h.length;e++){var t=h[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(u,t.key,t)}}function p(u,h,e){return h&&_(u.prototype,h),e&&_(u,e),u}var T=(function(){function u(h){var e=this;x(this,u),this.gl=h,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.samplers={},this.clouds2Image=new Image,this.clouds2Image.onload=function(){e.samplers.clouds2=e.gl.createTexture(),e.bindTexture(e.samplers.clouds2,e.clouds2Image,128,128)},this.clouds2Image.src="data:image/jpeg;base64,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",this.emptyImage=new Image,this.emptyImage.onload=function(){e.samplers.empty=e.gl.createTexture(),e.bindTexture(e.samplers.empty,e.emptyImage,1,1)},this.emptyImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}return p(u,[{key:"bindTexture",value:function(e,t,i,s){if(this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,i,s,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){var a=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,a)}}},{key:"loadExtraImages",value:function(e){var t=this;Object.keys(e).forEach(function(i){var s=e[i],a=s.data,l=s.width,n=s.height;if(!t.samplers[i]){var o=new Image;o.onload=function(){t.samplers[i]=t.gl.createTexture(),t.bindTexture(t.samplers[i],o,l,n)},o.src=a}})}},{key:"getTexture",value:function(e){var t=this.samplers[e];return t||this.samplers.clouds2}}]),u})()}),"./src/index.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return i});var x=c("./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js"),_=c.n(x),p=c("./src/presetBase.js"),T=c.n(p),u=c("./src/visualizer.js");function h(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}function e(s,a){for(var l=0;l<a.length;l++){var n=a[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,n.key,n)}}function t(s,a,l){return a&&e(s.prototype,a),l&&e(s,l),s}var i=(function(){function s(){h(this,s)}return t(s,null,[{key:"createVisualizer",value:function(l,n,o){return new u.default(l,n,o)}}]),s})()}),"./src/noise/noise.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return T});function x(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function _(u,h){for(var e=0;e<h.length;e++){var t=h[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(u,t.key,t)}}function p(u,h,e){return h&&_(u.prototype,h),e&&_(u,e),u}var T=(function(){function u(h){x(this,u),this.gl=h,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.noiseTexLQ=this.gl.createTexture(),this.noiseTexLQLite=this.gl.createTexture(),this.noiseTexMQ=this.gl.createTexture(),this.noiseTexHQ=this.gl.createTexture(),this.noiseTexVolLQ=this.gl.createTexture(),this.noiseTexVolHQ=this.gl.createTexture(),this.nTexArrLQ=u.createNoiseTex(256,1),this.nTexArrLQLite=u.createNoiseTex(32,1),this.nTexArrMQ=u.createNoiseTex(256,4),this.nTexArrHQ=u.createNoiseTex(256,8),this.nTexArrVolLQ=u.createNoiseVolTex(32,1),this.nTexArrVolHQ=u.createNoiseVolTex(32,4),this.bindTexture(this.noiseTexLQ,this.nTexArrLQ,256,256),this.bindTexture(this.noiseTexLQLite,this.nTexArrLQLite,32,32),this.bindTexture(this.noiseTexMQ,this.nTexArrMQ,256,256),this.bindTexture(this.noiseTexHQ,this.nTexArrHQ,256,256),this.bindTexture3D(this.noiseTexVolLQ,this.nTexArrVolLQ,32,32,32),this.bindTexture3D(this.noiseTexVolHQ,this.nTexArrVolHQ,32,32,32),this.noiseTexPointLQ=this.gl.createSampler(),h.samplerParameteri(this.noiseTexPointLQ,h.TEXTURE_MIN_FILTER,h.NEAREST_MIPMAP_NEAREST),h.samplerParameteri(this.noiseTexPointLQ,h.TEXTURE_MAG_FILTER,h.NEAREST),h.samplerParameteri(this.noiseTexPointLQ,h.TEXTURE_WRAP_S,h.REPEAT),h.samplerParameteri(this.noiseTexPointLQ,h.TEXTURE_WRAP_T,h.REPEAT)}return p(u,[{key:"bindTexture",value:function(e,t,i,s){if(this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,i,s,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){var a=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,a)}}},{key:"bindTexture3D",value:function(e,t,i,s,a){if(this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.gl.RGBA,i,s,a,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_3D),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){var l=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_3D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,l)}}}],[{key:"fCubicInterpolate",value:function(e,t,i,s,a){var l=a*a,n=a*l,o=s-i-e+t,r=e-t-o,d=i-e,P=t;return o*n+r*l+d*a+P}},{key:"dwCubicInterpolate",value:function(e,t,i,s,a){for(var l=[],n=0;n<4;n++){var o=u.fCubicInterpolate(e[n]/255,t[n]/255,i[n]/255,s[n]/255,a);o=Math.clamp(o,0,1),l[n]=o*255}return l}},{key:"createNoiseVolTex",value:function(e,t){for(var i=e*e*e,s=new Uint8Array(i*4),a=t>1?216:256,l=a*.5,n=0;n<i;n++)s[n*4+0]=Math.floor(Math.random()*a+l),s[n*4+1]=Math.floor(Math.random()*a+l),s[n*4+2]=Math.floor(Math.random()*a+l),s[n*4+3]=Math.floor(Math.random()*a+l);var o=e*e,r=e;if(t>1){for(var d=0;d<e;d+=t)for(var P=0;P<e;P+=t)for(var E=0;E<e;E++)if(E%t!==0){for(var v=Math.floor(E/t)*t+e,b=d*o+P*r,U=[],D=[],C=[],w=[],L=0;L<4;L++)U[L]=s[b*4+(v-t)%e*4+L],D[L]=s[b*4+v%e*4+L],C[L]=s[b*4+(v+t)%e*4+L],w[L]=s[b*4+(v+t*2)%e*4+L];for(var A=E%t/t,f=u.dwCubicInterpolate(U,D,C,w,A),g=0;g<4;g++){var m=E*4+g;s[d*o*4+P*r*4+m]=f[g]}}for(var B=0;B<e;B+=t)for(var R=0;R<e;R++)for(var q=0;q<e;q++)if(q%t!==0){for(var y=Math.floor(q/t)*t+e,I=B*o,F=[],W=[],H=[],N=[],k=0;k<4;k++){var G=R*4+I*4+k;F[k]=s[(y-t)%e*r*4+G],W[k]=s[y%e*r*4+G],H[k]=s[(y+t)%e*r*4+G],N[k]=s[(y+t*2)%e*r*4+G]}for(var it=q%t/t,Z=u.dwCubicInterpolate(F,W,H,N,it),Q=0;Q<4;Q++){var K=R*4+I*4+Q;s[q*r*4+K]=Z[Q]}}for(var X=0;X<e;X++)for(var O=0;O<e;O++)for(var J=0;J<e;J++)if(J%t!==0){for(var st=O*r,et=Math.floor(J/t)*t+e,Y=[],V=[],at=[],ft=[],tt=0;tt<4;tt++){var ot=X*4+st*4+tt;Y[tt]=s[(et-t)%e*o*4+ot],V[tt]=s[et%e*o*4+ot],at[tt]=s[(et+t)%e*o*4+ot],ft[tt]=s[(et+t*2)%e*o*4+ot]}for(var rt=O%t/t,lt=u.dwCubicInterpolate(Y,V,at,ft,rt),ht=0;ht<4;ht++){var Lt=X*4+st*4+ht;s[J*o*4+Lt]=lt[ht]}}}return s}},{key:"createNoiseTex",value:function(e,t){for(var i=e*e,s=new Uint8Array(i*4),a=t>1?216:256,l=a*.5,n=0;n<i;n++)s[n*4+0]=Math.floor(Math.random()*a+l),s[n*4+1]=Math.floor(Math.random()*a+l),s[n*4+2]=Math.floor(Math.random()*a+l),s[n*4+3]=Math.floor(Math.random()*a+l);if(t>1){for(var o=0;o<e;o+=t)for(var r=0;r<e;r++)if(r%t!==0){for(var d=Math.floor(r/t)*t+e,P=o*e,E=[],v=[],b=[],U=[],D=0;D<4;D++)E[D]=s[P*4+(d-t)%e*4+D],v[D]=s[P*4+d%e*4+D],b[D]=s[P*4+(d+t)%e*4+D],U[D]=s[P*4+(d+t*2)%e*4+D];for(var C=r%t/t,w=u.dwCubicInterpolate(E,v,b,U,C),L=0;L<4;L++)s[o*e*4+r*4+L]=w[L]}for(var A=0;A<e;A++)for(var f=0;f<e;f++)if(f%t!==0){for(var g=Math.floor(f/t)*t+e,m=[],B=[],R=[],q=[],y=0;y<4;y++)m[y]=s[(g-t)%e*e*4+A*4+y],B[y]=s[g%e*e*4+A*4+y],R[y]=s[(g+t)%e*e*4+A*4+y],q[y]=s[(g+t*2)%e*e*4+A*4+y];for(var I=f%t/t,F=u.dwCubicInterpolate(m,B,R,q,I),W=0;W<4;W++)s[f*e*4+A*4+W]=F[W]}}return s}}]),u})()}),"./src/presetBase.js":(function(S,M){var c=1e-5;window.sqr=function(p){return p*p},window.sqrt=function(p){return Math.sqrt(Math.abs(p))},window.log10=function(p){return Math.log(p)*Math.LOG10E},window.sign=function(p){return p>0?1:p<0?-1:0},window.rand=function(p){var T=Math.floor(p);return T<1?Math.random():Math.random()*T},window.randint=function(p){return Math.floor(rand(p))},window.bnot=function(p){return Math.abs(p)<c?1:0};function x(_){return isFinite(_)&&!isNaN(_)}window.pow=function(p,T){var u=Math.pow(p,T);return x(u)?u:0},window.div=function(p,T){return T===0?0:p/T},window.mod=function(p,T){if(T===0)return 0;var u=Math.floor(p)%Math.floor(T);return u},window.bitor=function(p,T){var u=Math.floor(p)|Math.floor(T);return u},window.bitand=function(p,T){var u=Math.floor(p)&Math.floor(T);return u},window.sigmoid=function(p,T){var u=1+Math.exp(-p*T);return Math.abs(u)>c?1/u:0},window.bor=function(p,T){return Math.abs(p)>c||Math.abs(T)>c?1:0},window.band=function(p,T){return Math.abs(p)>c&&Math.abs(T)>c?1:0},window.equal=function(p,T){return Math.abs(p-T)<c?1:0},window.above=function(p,T){return p>T?1:0},window.below=function(p,T){return p<T?1:0},window.ifcond=function(p,T,u){return Math.abs(p)>c?T:u},window.memcpy=function(p,T,u,h){var e=T,t=u,i=h;return t<0&&(i+=t,e-=t,t=0),e<0&&(i+=e,t-=e,e=0),i>0&&p.copyWithin(e,t,i),T}}),"./src/rendering/blendPattern.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return T});function x(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function _(u,h){for(var e=0;e<h.length;e++){var t=h[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(u,t.key,t)}}function p(u,h,e){return h&&_(u.prototype,h),e&&_(u,e),u}var T=(function(){function u(h){x(this,u),this.mesh_width=h.mesh_width,this.mesh_height=h.mesh_height,this.aspectx=h.aspectx,this.aspecty=h.aspecty,this.vertInfoA=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.vertInfoC=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.createBlendPattern()}return p(u,[{key:"updateGlobals",value:function(e){var t=this.mesh_width,i=this.mesh_height;this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,(this.mesh_width!==t||this.mesh_height!==i)&&(this.vertInfoA=u.resizeMatrixValues(this.vertInfoA,t,i,this.mesh_width,this.mesh_height),this.vertInfoC=u.resizeMatrixValues(this.vertInfoC,t,i,this.mesh_width,this.mesh_height))}},{key:"genPlasma",value:function(e,t,i,s,a){var l=Math.floor((e+t)/2),n=Math.floor((i+s)/2),o=this.vertInfoC[i*(this.mesh_width+1)+e],r=this.vertInfoC[i*(this.mesh_width+1)+t],d=this.vertInfoC[s*(this.mesh_width+1)+e],P=this.vertInfoC[s*(this.mesh_width+1)+t];s-i>=2&&(e===0&&(this.vertInfoC[n*(this.mesh_width+1)+e]=.5*(o+d)+(Math.random()*2-1)*a*this.aspecty),this.vertInfoC[n*(this.mesh_width+1)+t]=.5*(r+P)+(Math.random()*2-1)*a*this.aspecty),t-e>=2&&(i===0&&(this.vertInfoC[i*(this.mesh_width+1)+l]=.5*(o+r)+(Math.random()*2-1)*a*this.aspectx),this.vertInfoC[s*(this.mesh_width+1)+l]=.5*(d+P)+(Math.random()*2-1)*a*this.aspectx),s-i>=2&&t-e>=2&&(o=this.vertInfoC[n*(this.mesh_width+1)+e],r=this.vertInfoC[n*(this.mesh_width+1)+t],d=this.vertInfoC[i*(this.mesh_width+1)+l],P=this.vertInfoC[s*(this.mesh_width+1)+l],this.vertInfoC[n*(this.mesh_width+1)+l]=.25*(d+P+o+r)+(Math.random()*2-1)*a,this.genPlasma(e,l,i,n,a*.5),this.genPlasma(l,t,i,n,a*.5),this.genPlasma(e,l,n,s,a*.5),this.genPlasma(l,t,n,s,a*.5))}},{key:"createBlendPattern",value:function(){var e=1+Math.floor(Math.random()*3);if(e===0)for(var t=0,i=0;i<=this.mesh_height;i++)for(var s=0;s<=this.mesh_width;s++)this.vertInfoA[t]=1,this.vertInfoC[t]=0,t+=1;else if(e===1)for(var a=Math.random()*6.28,l=Math.cos(a),n=Math.sin(a),o=.1+.2*Math.random(),r=1/o,d=0,P=0;P<=this.mesh_height;P++)for(var E=P/this.mesh_height*this.aspecty,v=0;v<=this.mesh_width;v++){var b=v/this.mesh_width*this.aspectx,U=(b-.5)*l+(E-.5)*n+.5;U=(U-.5)/Math.sqrt(2)+.5,this.vertInfoA[d]=r*(1+o),this.vertInfoC[d]=-r+r*U,d+=1}else if(e===2){var D=.12+.13*Math.random(),C=1/D;this.vertInfoC[0]=Math.random(),this.vertInfoC[this.mesh_width]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)+this.mesh_width]=Math.random(),this.genPlasma(0,this.mesh_width,0,this.mesh_height,.25);for(var w=this.vertInfoC[0],L=this.vertInfoC[0],A=0,f=0;f<=this.mesh_height;f++)for(var g=0;g<=this.mesh_width;g++)w>this.vertInfoC[A]&&(w=this.vertInfoC[A]),L<this.vertInfoC[A]&&(L=this.vertInfoC[A]),A+=1;var m=1/(L-w);A=0;for(var B=0;B<=this.mesh_height;B++)for(var R=0;R<=this.mesh_width;R++){var q=(this.vertInfoC[A]-w)*m;this.vertInfoA[A]=C*(1+D),this.vertInfoC[A]=-C+C*q,A+=1}}else if(e===3)for(var y=.02+.14*Math.random()+.34*Math.random(),I=1/y,F=Math.floor(Math.random()*2)*2-1,W=0,H=0;H<=this.mesh_height;H++)for(var N=(H/this.mesh_height-.5)*this.aspecty,k=0;k<=this.mesh_width;k++){var G=(k/this.mesh_width-.5)*this.aspectx,it=Math.sqrt(G*G+N*N)*1.41421;F===-1&&(it=1-it),this.vertInfoA[W]=I*(1+y),this.vertInfoC[W]=-I+I*it,W+=1}}}],[{key:"resizeMatrixValues",value:function(e,t,i,s,a){for(var l=new Float32Array((s+1)*(a+1)),n=0,o=0;o<a+1;o++)for(var r=0;r<s+1;r++){var d=r/a,P=o/s;d*=t+1,P*=i+1,d=Math.clamp(d,0,t-1),P=Math.clamp(P,0,i-1);var E=Math.floor(d),v=Math.floor(P),b=d-E,U=P-v,D=e[v*(t+1)+E],C=e[v*(t+1)+(E+1)],w=e[(v+1)*(t+1)+E],L=e[(v+1)*(t+1)+(E+1)];l[n]=D*(1-b)*(1-U)+C*b*(1-U)+w*(1-b)*U+L*b*U,n+=1}return l}}]),u})()}),"./src/rendering/motionVectors/motionVectors.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e,t){_(this,h),this.gl=e,this.maxX=64,this.maxY=48,this.positions=new Float32Array(this.maxX*this.maxY*2*3),this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.positionVertexBuf=this.gl.createBuffer(),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader()}return T(h,[{key:"updateGlobals",value:function(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height}},{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
                                      in vec3 aPos;
                                      void main(void) {
                                        gl_Position = vec4(aPos, 1.0);
                                      }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      out vec4 fragColor;
                                      uniform vec4 u_color;
                                      void main(void) {
                                        fragColor = u_color;
                                      }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}},{key:"getMotionDir",value:function(t,i,s){var a=Math.floor(s*this.mesh_height),l=s*this.mesh_height-a,n=Math.floor(i*this.mesh_width),o=i*this.mesh_width-n,r=n+1,d=a+1,P=this.mesh_width+1,E,v;return E=t[(a*P+n)*2+0]*(1-o)*(1-l),v=t[(a*P+n)*2+1]*(1-o)*(1-l),E+=t[(a*P+r)*2+0]*o*(1-l),v+=t[(a*P+r)*2+1]*o*(1-l),E+=t[(d*P+n)*2+0]*(1-o)*l,v+=t[(d*P+n)*2+1]*(1-o)*l,E+=t[(d*P+r)*2+0]*o*l,v+=t[(d*P+r)*2+1]*o*l,[E,1-v]}},{key:"generateMotionVectors",value:function(t,i){var s=t.mv_a,a=Math.floor(t.mv_x),l=Math.floor(t.mv_y);if(s>.001&&a>0&&l>0){var n=t.mv_x-a,o=t.mv_y-l;a>this.maxX&&(a=this.maxX,n=0),l>this.maxY&&(l=this.maxY,o=0);var r=t.mv_dx,d=t.mv_dy,P=t.mv_l,E=1/this.texsizeX;this.numVecVerts=0;for(var v=0;v<l;v++){var b=(v+.25)/(l+o+.25-1);if(b-=d,b>1e-4&&b<.9999)for(var U=0;U<a;U++){var D=(U+.25)/(a+n+.25-1);if(D+=r,D>1e-4&&D<.9999){var C=this.getMotionDir(i,D,b),w=C[0],L=C[1],A=w-D,f=L-b;A*=P,f*=P;var g=Math.sqrt(A*A+f*f);g<E&&g>1e-8?(g=E/g,A*=g,f*=g):(A=E,A=E),w=D+A,L=b+f;var m=2*D-1,B=2*b-1,R=2*w-1,q=2*L-1;this.positions[this.numVecVerts*3+0]=m,this.positions[this.numVecVerts*3+1]=B,this.positions[this.numVecVerts*3+2]=0,this.positions[(this.numVecVerts+1)*3+0]=R,this.positions[(this.numVecVerts+1)*3+1]=q,this.positions[(this.numVecVerts+1)*3+2]=0,this.numVecVerts+=2}}}if(this.numVecVerts>0)return this.color=[t.mv_r,t.mv_g,t.mv_b,s],!0}return!1}},{key:"drawMotionVectors",value:function(t,i){this.generateMotionVectors(t,i)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color),this.gl.lineWidth(1),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.LINES,0,this.numVecVerts))}}]),h})()}),"./src/rendering/renderer.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return w});var x=c("./src/audio/audioLevels.js"),_=c("./src/blankPreset.js"),p=c.n(_),T=c("./src/equations/presetEquationRunner.js"),u=c("./src/rendering/waves/basicWaveform.js"),h=c("./src/rendering/waves/customWaveform.js"),e=c("./src/rendering/shapes/customShape.js"),t=c("./src/rendering/sprites/border.js"),i=c("./src/rendering/sprites/darkenCenter.js"),s=c("./src/rendering/motionVectors/motionVectors.js"),a=c("./src/rendering/shaders/warp.js"),l=c("./src/rendering/shaders/comp.js"),n=c("./src/rendering/shaders/output.js"),o=c("./src/rendering/shaders/resample.js"),r=c("./src/rendering/shaders/blur/blur.js"),d=c("./src/noise/noise.js"),P=c("./src/image/imageTextures.js"),E=c("./src/rendering/text/titleText.js"),v=c("./src/rendering/blendPattern.js"),b=c("./src/utils.js");function U(L,A){if(!(L instanceof A))throw new TypeError("Cannot call a class as a function")}function D(L,A){for(var f=0;f<A.length;f++){var g=A[f];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(L,g.key,g)}}function C(L,A,f){return A&&D(L.prototype,A),f&&D(L,f),L}var w=(function(){function L(A,f,g){U(this,L),this.gl=A,this.audio=f,this.frameNum=0,this.fps=30,this.time=0,this.presetTime=0,this.lastTime=performance.now(),this.timeHist=[0],this.timeHistMax=120,this.blending=!1,this.blendStartTime=0,this.blendProgress=0,this.blendDuration=0,this.width=g.width||1200,this.height=g.height||900,this.mesh_width=g.meshWidth||48,this.mesh_height=g.meshHeight||36,this.pixelRatio=g.pixelRatio||window.devicePixelRatio||1,this.textureRatio=g.textureRatio||1,this.outputFXAA=g.outputFXAA||!1,this.texsizeX=this.width*this.pixelRatio*this.textureRatio,this.texsizeY=this.height*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=b.default.range(1,33).map(function(R){return"q".concat(R)}),this.ts=b.default.range(1,9).map(function(R){return"t".concat(R)}),this.regs=b.default.range(0,100).map(function(R){return R<10?"reg0".concat(R):"reg".concat(R)}),this.blurRatios=[[.5,.25],[.125,.125],[.0625,.0625]],this.audioLevels=new x.default(this.audio),this.prevFrameBuffer=this.gl.createFramebuffer(),this.targetFrameBuffer=this.gl.createFramebuffer(),this.prevTexture=this.gl.createTexture(),this.targetTexture=this.gl.createTexture(),this.compFrameBuffer=this.gl.createFramebuffer(),this.compTexture=this.gl.createTexture(),this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.targetFrameBuffer,this.targetTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture);var m={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.noise=new d.default(A),this.image=new P.default(A),this.warpShader=new a.default(A,this.noise,this.image,m),this.compShader=new l.default(A,this.noise,this.image,m),this.outputShader=new n.default(A,m),this.prevWarpShader=new a.default(A,this.noise,this.image,m),this.prevCompShader=new l.default(A,this.noise,this.image,m),this.numBlurPasses=0,this.blurShader1=new r.default(0,this.blurRatios,A,m),this.blurShader2=new r.default(1,this.blurRatios,A,m),this.blurShader3=new r.default(2,this.blurRatios,A,m),this.blurTexture1=this.blurShader1.blurVerticalTexture,this.blurTexture2=this.blurShader2.blurVerticalTexture,this.blurTexture3=this.blurShader3.blurVerticalTexture,this.basicWaveform=new u.default(A,m),this.customWaveforms=b.default.range(4).map(function(R){return new h.default(R,A,m)}),this.customShapes=b.default.range(4).map(function(R){return new e.default(R,A,m)}),this.prevCustomWaveforms=b.default.range(4).map(function(R){return new h.default(R,A,m)}),this.prevCustomShapes=b.default.range(4).map(function(R){return new e.default(R,A,m)}),this.darkenCenter=new i.default(A,m),this.innerBorder=new t.default(A,m),this.outerBorder=new t.default(A,m),this.motionVectors=new s.default(A,m),this.titleText=new E.default(A,m),this.blendPattern=new v.default(m),this.resampleShader=new o.default(A),this.supertext={startTime:-1},this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.gl.clearColor(0,0,0,1),this.blankPreset=p.a;var B={frame:0,time:0,fps:45,bass:1,bass_att:1,mid:1,mid_att:1,treb:1,treb_att:1};this.preset=p.a,this.prevPreset=this.preset,this.presetEquationRunner=new T.default(this.preset,B,m),this.prevPresetEquationRunner=new T.default(this.prevPreset,B,m),this.regVars=this.presetEquationRunner.mdVSRegs}return C(L,[{key:"loadPreset",value:function(f,g){this.blendPattern.createBlendPattern(),this.blending=!0,this.blendStartTime=this.time,this.blendDuration=g,this.blendProgress=0,this.prevPresetEquationRunner=this.presetEquationRunner,this.prevPreset=this.preset,this.preset=f,this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetTime=this.time;var m={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att},B={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.presetEquationRunner=new T.default(this.preset,m,B),this.regVars=this.presetEquationRunner.mdVSRegs;var R=this.prevWarpShader;this.prevWarpShader=this.warpShader,this.warpShader=R;var q=this.prevCompShader;this.prevCompShader=this.compShader,this.compShader=q;var y=this.preset.warp.trim(),I=this.preset.comp.trim();this.warpShader.updateShader(y),this.compShader.updateShader(I),y.length===0?this.numBlurPasses=0:this.numBlurPasses=L.getHighestBlur(y),I.length!==0&&(this.numBlurPasses=Math.max(this.numBlurPasses,L.getHighestBlur(I)))}},{key:"loadExtraImages",value:function(f){this.image.loadExtraImages(f)}},{key:"setRendererSize",value:function(f,g,m){var B=this.texsizeX,R=this.texsizeY;if(this.width=f,this.height=g,this.mesh_width=m.meshWidth||this.mesh_width,this.mesh_height=m.meshHeight||this.mesh_height,this.pixelRatio=m.pixelRatio||this.pixelRatio,this.textureRatio=m.textureRatio||this.textureRatio,this.texsizeX=f*this.pixelRatio*this.textureRatio,this.texsizeY=g*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.texsizeX!==B||this.texsizeY!==R){var q=this.gl.createTexture();this.bindFrameBufferTexture(this.targetFrameBuffer,q),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.resampleShader.renderQuadTexture(this.targetTexture),this.targetTexture=q,this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture)}this.updateGlobals(),this.frameNum>0&&this.renderToScreen()}},{key:"setInternalMeshSize",value:function(f,g){this.mesh_width=f,this.mesh_height=g,this.updateGlobals()}},{key:"setOutputAA",value:function(f){this.outputFXAA=f}},{key:"updateGlobals",value:function(){var f={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.presetEquationRunner.updateGlobals(f),this.prevPresetEquationRunner.updateGlobals(f),this.warpShader.updateGlobals(f),this.prevWarpShader.updateGlobals(f),this.compShader.updateGlobals(f),this.prevCompShader.updateGlobals(f),this.outputShader.updateGlobals(f),this.blurShader1.updateGlobals(f),this.blurShader2.updateGlobals(f),this.blurShader3.updateGlobals(f),this.basicWaveform.updateGlobals(f),this.customWaveforms.forEach(function(g){return g.updateGlobals(f)}),this.customShapes.forEach(function(g){return g.updateGlobals(f)}),this.prevCustomWaveforms.forEach(function(g){return g.updateGlobals(f)}),this.prevCustomShapes.forEach(function(g){return g.updateGlobals(f)}),this.darkenCenter.updateGlobals(f),this.innerBorder.updateGlobals(f),this.outerBorder.updateGlobals(f),this.motionVectors.updateGlobals(f),this.titleText.updateGlobals(f),this.blendPattern.updateGlobals(f),this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4)}},{key:"calcTimeAndFPS",value:function(f){var g;if(f)g=f;else{var m=performance.now();g=(m-this.lastTime)/1e3,(g>1||g<0||this.frame<2)&&(g=1/30),this.lastTime=m}this.time+=1/this.fps,this.blending&&(this.blendProgress=(this.time-this.blendStartTime)/this.blendDuration,this.blendProgress>1&&(this.blending=!1));var B=this.timeHist[this.timeHist.length-1]+g;this.timeHist.push(B),this.timeHist.length>this.timeHistMax&&this.timeHist.shift();var R=this.timeHist.length/(B-this.timeHist[0]);if(Math.abs(R-this.fps)>3&&this.frame>this.timeHistMax)this.fps=R;else{var q=.93;this.fps=q*this.fps+(1-q)*R}}},{key:"runPixelEquations",value:function(f,g,m,B){for(var R=this.mesh_width,q=this.mesh_height,y=R+1,I=q+1,F=this.time*g.warpanimspeed,W=1/g.warpscale,H=11.68+4*Math.cos(F*1.413+10),N=8.77+3*Math.cos(F*1.113+7),k=10.54+3*Math.cos(F*1.233+3),G=11.49+4*Math.cos(F*.933+5),it=0/this.texsizeX,Z=0/this.texsizeY,Q=this.aspectx,K=this.aspecty,X=b.default.cloneVars(g),O=0,J=0,st=0;st<I;st++)for(var et=0;et<y;et++){var Y=et/R*2-1,V=st/q*2-1,at=Math.sqrt(Y*Y*Q*Q+V*V*K*K);if(m){var ft=void 0;st===q/2&&et===R/2?ft=0:ft=b.default.atan2(V*K,Y*Q),X.x=Y*.5*Q+.5,X.y=V*-.5*K+.5,X.rad=at,X.ang=ft,X.zoom=g.zoom,X.zoomexp=g.zoomexp,X.rot=g.rot,X.warp=g.warp,X.cx=g.cx,X.cy=g.cy,X.dx=g.dx,X.dy=g.dy,X.sx=g.sx,X.sy=g.sy,X=f.pixel_eqs(X)}var tt=X.warp,ot=X.zoom,rt=X.zoomexp,lt=X.cx,ht=X.cy,Lt=X.sx,Yt=X.sy,Mt=X.dx,mt=X.dy,gt=X.rot,ct=Math.pow(ot,Math.pow(rt,at*2-1)),$=1/ct,j=Y*.5*Q*$+.5,z=-V*.5*K*$+.5;j=(j-lt)/Lt+lt,z=(z-ht)/Yt+ht,tt!==0&&(j+=tt*.0035*Math.sin(F*.333+W*(Y*H-V*G)),z+=tt*.0035*Math.cos(F*.375-W*(Y*k+V*N)),j+=tt*.0035*Math.cos(F*.753-W*(Y*N-V*k)),z+=tt*.0035*Math.sin(F*.825+W*(Y*H+V*G)));var Ut=j-lt,At=z-ht,dt=Math.cos(gt),It=Math.sin(gt);if(j=Ut*dt-At*It+lt,z=Ut*It+At*dt+ht,j-=Mt,z-=mt,j=(j-.5)/Q+.5,z=(z-.5)/K+.5,j+=it,z+=Z,!B)this.warpUVs[O]=j,this.warpUVs[O+1]=z,this.warpColor[J+0]=1,this.warpColor[J+1]=1,this.warpColor[J+2]=1,this.warpColor[J+3]=1;else{var vt=this.blendPattern.vertInfoA[O/2]*this.blendProgress+this.blendPattern.vertInfoC[O/2];vt=Math.clamp(vt,0,1),this.warpUVs[O]=this.warpUVs[O]*vt+j*(1-vt),this.warpUVs[O+1]=this.warpUVs[O+1]*vt+z*(1-vt),this.warpColor[J+0]=1,this.warpColor[J+1]=1,this.warpColor[J+2]=1,this.warpColor[J+3]=vt}O+=2,J+=4}this.mdVSVertex=X}},{key:"bindFrambufferAndSetViewport",value:function(f,g,m){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,f),this.gl.viewport(0,0,g,m)}},{key:"bindFrameBufferTexture",value:function(f,g){if(this.gl.bindTexture(this.gl.TEXTURE_2D,g),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(this.texsizeX*this.texsizeY*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){var m=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,m)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,f),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,g,0)}},{key:"render",value:function(){var f=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=g.audioLevels,B=g.elapsedTime;this.calcTimeAndFPS(B),this.frameNum+=1,m?this.audio.updateAudio(m.timeByteArray,m.timeByteArrayL,m.timeByteArrayR):this.audio.sampleAudio(),this.audioLevels.updateAudioLevels(this.fps,this.frameNum);var R={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY},q=Object.assign({},R);q.gmegabuf=this.prevPresetEquationRunner.gmegabuf,R.gmegabuf=this.presetEquationRunner.gmegabuf,Object.assign(R,this.regVars),this.presetEquationRunner.runFrameEquations(R);var y=this.presetEquationRunner.mdVSFrame;this.runPixelEquations(this.presetEquationRunner.preset,y,this.presetEquationRunner.runVertEQs,!1),Object.assign(this.regVars,b.default.pick(this.mdVSVertex,this.regs)),Object.assign(R,this.regVars);var I;this.blending?(this.prevPresetEquationRunner.runFrameEquations(q),this.runPixelEquations(this.prevPresetEquationRunner.preset,this.prevPresetEquationRunner.mdVSFrame,this.prevPresetEquationRunner.runVertEQs,!0),I=L.mixFrameEquations(this.blendProgress,y,this.prevPresetEquationRunner.mdVSFrame)):I=y;var F=this.targetTexture;this.targetTexture=this.prevTexture,this.prevTexture=F;var W=this.targetFrameBuffer;this.targetFrameBuffer=this.prevFrameBuffer,this.prevFrameBuffer=W,this.gl.bindTexture(this.gl.TEXTURE_2D,this.prevTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);var H=L.getBlurValues(I),N=H.blurMins,k=H.blurMaxs;this.blending?(this.prevWarpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,N,k,this.prevPresetEquationRunner.mdVSFrame,this.warpUVs,this.warpColor),this.warpShader.renderQuadTexture(!0,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,N,k,I,this.warpUVs,this.warpColor)):this.warpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,N,k,y,this.warpUVs,this.warpColor),this.numBlurPasses>0&&(this.blurShader1.renderBlurTexture(this.targetTexture,y,N,k),this.numBlurPasses>1&&(this.blurShader2.renderBlurTexture(this.blurTexture1,y,N,k),this.numBlurPasses>2&&this.blurShader3.renderBlurTexture(this.blurTexture2,y,N,k)),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY)),this.motionVectors.drawMotionVectors(I,this.warpUVs),this.preset.shapes&&this.preset.shapes.length>0&&this.customShapes.forEach(function(Q,K){Q.drawCustomShape(f.blending?f.blendProgress:1,R,f.presetEquationRunner,f.preset.shapes[K],f.prevTexture)}),this.preset.waves&&this.preset.waves.length>0&&this.customWaveforms.forEach(function(Q,K){Q.drawCustomWaveform(f.blending?f.blendProgress:1,f.audio.timeArrayL,f.audio.timeArrayR,f.audio.freqArrayL,f.audio.freqArrayR,R,f.presetEquationRunner,f.preset.waves[K])}),this.blending&&(this.prevPreset.shapes&&this.prevPreset.shapes.length>0&&this.prevCustomShapes.forEach(function(Q,K){Q.drawCustomShape(1-f.blendProgress,q,f.prevPresetEquationRunner,f.prevPreset.shapes[K],f.prevTexture)}),this.prevPreset.waves&&this.prevPreset.waves.length>0&&this.prevCustomWaveforms.forEach(function(Q,K){Q.drawCustomWaveform(1-f.blendProgress,f.audio.timeArrayL,f.audio.timeArrayR,f.audio.freqArrayL,f.audio.freqArrayR,q,f.prevPresetEquationRunner,f.prevPreset.waves[K])})),this.basicWaveform.drawBasicWaveform(this.blending,this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,I),this.darkenCenter.drawDarkenCenter(I);var G=[I.ob_r,I.ob_g,I.ob_b,I.ob_a];this.outerBorder.drawBorder(G,I.ob_size,0);var it=[I.ib_r,I.ib_g,I.ib_b,I.ib_a];if(this.innerBorder.drawBorder(it,I.ib_size,I.ob_size),this.supertext.startTime>=0){var Z=(this.time-this.supertext.startTime)/this.supertext.duration;Z>=1&&this.titleText.renderTitle(Z,!0,R)}this.globalVars=R,this.mdVSFrame=y,this.mdVSFrameMixed=I,this.renderToScreen()}},{key:"renderToScreen",value:function(){this.outputFXAA?this.bindFrambufferAndSetViewport(this.compFrameBuffer,this.texsizeX,this.texsizeY):this.bindFrambufferAndSetViewport(null,this.width,this.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);var f=L.getBlurValues(this.mdVSFrameMixed),g=f.blurMins,m=f.blurMaxs;if(this.blending?(this.prevCompShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,g,m,this.prevPresetEquationRunner.mdVSFrame,this.warpColor),this.compShader.renderQuadTexture(!0,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,g,m,this.mdVSFrameMixed,this.warpColor)):this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,g,m,this.mdVSFrame,this.warpColor),this.supertext.startTime>=0){var B=(this.time-this.supertext.startTime)/this.supertext.duration;this.titleText.renderTitle(B,!1,this.globalVars),B>=1&&(this.supertext.startTime=-1)}this.outputFXAA&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.compTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(null,this.width,this.height),this.outputShader.renderQuadTexture(this.compTexture))}},{key:"launchSongTitleAnim",value:function(f){this.supertext={startTime:this.time,duration:1.7},this.titleText.generateTitleTexture(f)}},{key:"toDataURL",value:function(){var f=this,g=new Uint8Array(this.texsizeX*this.texsizeY*4),m=this.gl.createFramebuffer(),B=this.gl.createTexture();this.bindFrameBufferTexture(m,B);var R=L.getBlurValues(this.mdVSFrameMixed),q=R.blurMins,y=R.blurMaxs;this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,q,y,this.mdVSFrame,this.warpColor),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,g),Array.from({length:this.texsizeY},function(H,N){return g.slice(N*f.texsizeX*4,(N+1)*f.texsizeX*4)}).forEach(function(H,N){return g.set(H,(f.texsizeY-N-1)*f.texsizeX*4)});var I=document.createElement("canvas");I.width=this.texsizeX,I.height=this.texsizeY;var F=I.getContext("2d"),W=F.createImageData(this.texsizeX,this.texsizeY);return W.data.set(g),F.putImageData(W,0,0),this.gl.deleteTexture(B),this.gl.deleteFramebuffer(m),I.toDataURL()}},{key:"warpBufferToDataURL",value:function(){var f=new Uint8Array(this.texsizeX*this.texsizeY*4);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.targetFrameBuffer),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,f);var g=document.createElement("canvas");g.width=this.texsizeX,g.height=this.texsizeY;var m=g.getContext("2d"),B=m.createImageData(this.texsizeX,this.texsizeY);return B.data.set(f),m.putImageData(B,0,0),g.toDataURL()}}],[{key:"getHighestBlur",value:function(f){return/sampler_blur3/.test(f)?3:/sampler_blur2/.test(f)?2:/sampler_blur1/.test(f)?1:0}},{key:"mixFrameEquations",value:function(f,g,m){var B=.5-.5*Math.cos(f*Math.PI),R=1-B,q=.5,y=b.default.cloneVars(g);return y.decay=B*g.decay+R*m.decay,y.wave_a=B*g.wave_a+R*m.wave_a,y.wave_r=B*g.wave_r+R*m.wave_r,y.wave_g=B*g.wave_g+R*m.wave_g,y.wave_b=B*g.wave_b+R*m.wave_b,y.wave_x=B*g.wave_x+R*m.wave_x,y.wave_y=B*g.wave_y+R*m.wave_y,y.wave_mystery=B*g.wave_mystery+R*m.wave_mystery,y.ob_size=B*g.ob_size+R*m.ob_size,y.ob_r=B*g.ob_r+R*m.ob_r,y.ob_g=B*g.ob_g+R*m.ob_g,y.ob_b=B*g.ob_b+R*m.ob_b,y.ob_a=B*g.ob_a+R*m.ob_a,y.ib_size=B*g.ib_size+R*m.ib_size,y.ib_r=B*g.ib_r+R*m.ib_r,y.ib_g=B*g.ib_g+R*m.ib_g,y.ib_b=B*g.ib_b+R*m.ib_b,y.ib_a=B*g.ib_a+R*m.ib_a,y.mv_x=B*g.mv_x+R*m.mv_x,y.mv_y=B*g.mv_y+R*m.mv_y,y.mv_dx=B*g.mv_dx+R*m.mv_dx,y.mv_dy=B*g.mv_dy+R*m.mv_dy,y.mv_l=B*g.mv_l+R*m.mv_l,y.mv_r=B*g.mv_r+R*m.mv_r,y.mv_g=B*g.mv_g+R*m.mv_g,y.mv_b=B*g.mv_b+R*m.mv_b,y.mv_a=B*g.mv_a+R*m.mv_a,y.echo_zoom=B*g.echo_zoom+R*m.echo_zoom,y.echo_alpha=B*g.echo_alpha+R*m.echo_alpha,y.echo_orient=B*g.echo_orient+R*m.echo_orient,y.wave_dots=B<q?m.wave_dots:g.wave_dots,y.wave_thick=B<q?m.wave_thick:g.wave_thick,y.additivewave=B<q?m.additivewave:g.additivewave,y.wave_brighten=B<q?m.wave_brighten:g.wave_brighten,y.darken_center=B<q?m.darken_center:g.darken_center,y.gammaadj=B<q?m.gammaadj:g.gammaadj,y.wrap=B<q?m.wrap:g.wrap,y.invert=B<q?m.invert:g.invert,y.brighten=B<q?m.brighten:g.brighten,y.darken=B<q?m.darken:g.darken,y.solarize=B<q?m.brighten:g.solarize,y.b1n=B*g.b1n+R*m.b1n,y.b2n=B*g.b2n+R*m.b2n,y.b3n=B*g.b3n+R*m.b3n,y.b1x=B*g.b1x+R*m.b1x,y.b2x=B*g.b2x+R*m.b2x,y.b3x=B*g.b3x+R*m.b3x,y.b1ed=B*g.b1ed+R*m.b1ed,y}},{key:"getBlurValues",value:function(f){var g=f.b1n,m=f.b2n,B=f.b3n,R=f.b1x,q=f.b2x,y=f.b3x,I=.1;if(R-g<I){var F=(g+R)*.5;g=F-I*.5,R=F-I*.5}if(q=Math.min(R,q),m=Math.max(g,m),q-m<I){var W=(m+q)*.5;m=W-I*.5,q=W-I*.5}if(y=Math.min(q,y),B=Math.max(m,B),y-B<I){var H=(B+y)*.5;B=H-I*.5,y=H-I*.5}return{blurMins:[g,m,B],blurMaxs:[R,q,y]}}}]),L})()}),"./src/rendering/shaders/blur/blur.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return h});var x=c("./src/rendering/shaders/blur/blurVertical.js"),_=c("./src/rendering/shaders/blur/blurHorizontal.js");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e,t,i){return t&&T(e.prototype,t),i&&T(e,i),e}var h=(function(){function e(t,i,s){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};p(this,e),this.blurLevel=t,this.blurRatios=i,this.gl=s,this.texsizeX=a.texsizeX,this.texsizeY=a.texsizeY,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.blurHorizontalFrameBuffer=this.gl.createFramebuffer(),this.blurVerticalFrameBuffer=this.gl.createFramebuffer(),this.blurHorizontalTexture=this.gl.createTexture(),this.blurVerticalTexture=this.gl.createTexture(),this.setupFrameBufferTextures(),this.blurHorizontal=new _.default(s,this.blurLevel,a),this.blurVertical=new x.default(s,this.blurLevel,a)}return u(e,[{key:"updateGlobals",value:function(i){this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.setupFrameBufferTextures()}},{key:"getTextureSize",value:function(i){var s=Math.max(this.texsizeX*i,16);s=Math.floor((s+3)/16)*16;var a=Math.max(this.texsizeY*i,16);return a=Math.floor((a+3)/4)*4,[s,a]}},{key:"setupFrameBufferTextures",value:function(){var i=this.blurLevel>0?this.blurRatios[this.blurLevel-1]:[1,1],s=this.blurRatios[this.blurLevel],a=this.getTextureSize(i[1]),l=this.getTextureSize(s[0]);this.bindFrameBufferTexture(this.blurHorizontalFrameBuffer,this.blurHorizontalTexture,l);var n=l,o=this.getTextureSize(s[1]);this.bindFrameBufferTexture(this.blurVerticalFrameBuffer,this.blurVerticalTexture,o),this.horizontalTexsizes=[a,l],this.verticalTexsizes=[n,o]}},{key:"bindFrambufferAndSetViewport",value:function(i,s){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,i),this.gl.viewport(0,0,s[0],s[1])}},{key:"bindFrameBufferTexture",value:function(i,s,a){if(this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,a[0],a[1],0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(a[0]*a[1]*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){var l=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,l)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,i),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,s,0)}},{key:"renderBlurTexture",value:function(i,s,a,l){this.bindFrambufferAndSetViewport(this.blurHorizontalFrameBuffer,this.horizontalTexsizes[1]),this.blurHorizontal.renderQuadTexture(i,s,a,l,this.horizontalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurHorizontalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.blurVerticalFrameBuffer,this.verticalTexsizes[1]),this.blurVertical.renderQuadTexture(this.blurHorizontalTexture,s,this.verticalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurVerticalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D)}}]),e})()}),"./src/rendering/shaders/blur/blurHorizontal.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e,t){_(this,h),this.gl=e,this.blurLevel=t;var i=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],s=i[0]+i[1],a=i[2]+i[3],l=i[4]+i[5],n=i[6]+i[7],o=0+2*i[1]/s,r=2+2*i[3]/a,d=4+2*i[5]/l,P=6+2*i[7]/n;this.ws=new Float32Array([s,a,l,n]),this.ds=new Float32Array([o,r,d,P]),this.wDiv=.5/(s+a+l+n),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader()}return T(h,[{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
                                      const vec2 halfmad = vec2(0.5);
                                      in vec2 aPos;
                                      out vec2 uv;
                                      void main(void) {
                                        gl_Position = vec4(aPos, 0.0, 1.0);
                                        uv = aPos * halfmad + halfmad;
                                      }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
       precision `.concat(this.floatPrecision,` float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform vec4 texsize;
       uniform float scale;
       uniform float bias;
       uniform vec4 ws;
       uniform vec4 ds;
       uniform float wdiv;

       void main(void) {
         float w1 = ws[0];
         float w2 = ws[1];
         float w3 = ws[2];
         float w4 = ws[3];
         float d1 = ds[0];
         float d2 = ds[1];
         float d3 = ds[2];
         float d4 = ds[3];

         vec2 uv2 = uv.xy;

         vec3 blur =
           ( texture(uTexture, uv2 + vec2( d1 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d1 * texsize.z,0.0) ).xyz) * w1 +
           ( texture(uTexture, uv2 + vec2( d2 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d2 * texsize.z,0.0) ).xyz) * w2 +
           ( texture(uTexture, uv2 + vec2( d3 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d3 * texsize.z,0.0) ).xyz) * w3 +
           ( texture(uTexture, uv2 + vec2( d4 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d4 * texsize.z,0.0) ).xyz) * w4;

         blur.xyz *= wdiv;
         blur.xyz = blur.xyz * scale + bias;

         fragColor = vec4(blur, 1.0);
       }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.scaleLoc=this.gl.getUniformLocation(this.shaderProgram,"scale"),this.biasLoc=this.gl.getUniformLocation(this.shaderProgram,"bias"),this.wsLoc=this.gl.getUniformLocation(this.shaderProgram,"ws"),this.dsLocation=this.gl.getUniformLocation(this.shaderProgram,"ds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}},{key:"getScaleAndBias",value:function(t,i){var s=[1,1,1],a=[0,0,0],l,n;return s[0]=1/(i[0]-t[0]),a[0]=-t[0]*s[0],l=(t[1]-t[0])/(i[0]-t[0]),n=(i[1]-t[0])/(i[0]-t[0]),s[1]=1/(n-l),a[1]=-l*s[1],l=(t[2]-t[1])/(i[1]-t[1]),n=(i[2]-t[1])/(i[1]-t[1]),s[2]=1/(n-l),a[2]=-l*s[2],{scale:s[this.blurLevel],bias:a[this.blurLevel]}}},{key:"renderQuadTexture",value:function(t,i,s,a,l){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0);var n=this.getScaleAndBias(s,a),o=n.scale,r=n.bias;this.gl.uniform4fv(this.texsizeLocation,[l[0],l[1],1/l[0],1/l[1]]),this.gl.uniform1f(this.scaleLoc,o),this.gl.uniform1f(this.biasLoc,r),this.gl.uniform4fv(this.wsLoc,this.ws),this.gl.uniform4fv(this.dsLocation,this.ds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}]),h})()}),"./src/rendering/shaders/blur/blurVertical.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e,t){_(this,h),this.gl=e,this.blurLevel=t;var i=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],s=i[0]+i[1]+i[2]+i[3],a=i[4]+i[5]+i[6]+i[7],l=0+2*((i[2]+i[3])/s),n=2+2*((i[6]+i[7])/a);this.wds=new Float32Array([s,a,l,n]),this.wDiv=1/((s+a)*2),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader()}return T(h,[{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
                                      const vec2 halfmad = vec2(0.5);
                                      in vec2 aPos;
                                      out vec2 uv;
                                      void main(void) {
                                        gl_Position = vec4(aPos, 0.0, 1.0);
                                        uv = aPos * halfmad + halfmad;
                                      }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
       precision `.concat(this.floatPrecision,` float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform vec4 texsize;
       uniform float ed1;
       uniform float ed2;
       uniform float ed3;
       uniform vec4 wds;
       uniform float wdiv;

       void main(void) {
         float w1 = wds[0];
         float w2 = wds[1];
         float d1 = wds[2];
         float d2 = wds[3];

         vec2 uv2 = uv.xy;

         vec3 blur =
           ( texture(uTexture, uv2 + vec2(0.0, d1 * texsize.w) ).xyz
           + texture(uTexture, uv2 + vec2(0.0,-d1 * texsize.w) ).xyz) * w1 +
           ( texture(uTexture, uv2 + vec2(0.0, d2 * texsize.w) ).xyz
           + texture(uTexture, uv2 + vec2(0.0,-d2 * texsize.w) ).xyz) * w2;

         blur.xyz *= wdiv;

         float t = min(min(uv.x, uv.y), 1.0 - max(uv.x, uv.y));
         t = sqrt(t);
         t = ed1 + ed2 * clamp(t * ed3, 0.0, 1.0);
         blur.xyz *= t;

         fragColor = vec4(blur, 1.0);
       }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.ed1Loc=this.gl.getUniformLocation(this.shaderProgram,"ed1"),this.ed2Loc=this.gl.getUniformLocation(this.shaderProgram,"ed2"),this.ed3Loc=this.gl.getUniformLocation(this.shaderProgram,"ed3"),this.wdsLocation=this.gl.getUniformLocation(this.shaderProgram,"wds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}},{key:"renderQuadTexture",value:function(t,i,s){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0);var a=this.blurLevel===0?i.b1ed:0;this.gl.uniform4fv(this.texsizeLocation,[s[0],s[1],1/s[0],1/s[1]]),this.gl.uniform1f(this.ed1Loc,1-a),this.gl.uniform1f(this.ed2Loc,a),this.gl.uniform1f(this.ed3Loc,5),this.gl.uniform4fv(this.wdsLocation,this.wds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}]),h})()}),"./src/rendering/shaders/comp.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e,t,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};_(this,h),this.gl=e,this.noise=t,this.image=i,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.compWidth=32,this.compHeight=24,this.buildPositions(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.compColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),e.samplerParameteri(this.mainSampler,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}return T(h,[{key:"buildPositions",value:function(){for(var t=2,i=2,s=t/2,a=i/2,l=this.compWidth,n=this.compHeight,o=l+1,r=n+1,d=t/l,P=i/n,E=[],v=0;v<r;v++)for(var b=v*P-a,U=0;U<o;U++){var D=U*d-s;E.push(D,-b,0)}for(var C=[],w=0;w<n;w++)for(var L=0;L<l;L++){var A=L+o*w,f=L+o*(w+1),g=L+1+o*(w+1),m=L+1+o*w;C.push(A,f,m),C.push(f,g,m)}this.vertices=new Float32Array(E),this.indices=new Uint16Array(C)}},{key:"updateGlobals",value:function(t){this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}},{key:"createShader",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i,s;if(t.length===0)i=`float orient_horiz = mod(echo_orientation, 2.0);
                        float orient_x = (orient_horiz != 0.0) ? -1.0 : 1.0;
                        float orient_y = (echo_orientation >= 2.0) ? -1.0 : 1.0;
                        vec2 uv_echo = ((uv - 0.5) *
                                        (1.0 / echo_zoom) *
                                        vec2(orient_x, orient_y)) + 0.5;

                        ret = mix(texture(sampler_main, uv).rgb,
                                  texture(sampler_main, uv_echo).rgb,
                                  echo_alpha);

                        ret *= gammaAdj;

                        if(fShader >= 1.0) {
                          ret *= hue_shader;
                        } else if(fShader > 0.001) {
                          ret *= (1.0 - fShader) + (fShader * hue_shader);
                        }

                        if(brighten != 0) ret = sqrt(ret);
                        if(darken != 0) ret = ret*ret;
                        if(solarize != 0) ret = ret * (1.0 - ret) * 4.0;
                        if(invert != 0) ret = 1.0 - ret;`,s="";else{var a=x.default.getShaderParts(t);s=a[0],i=a[1]}i=i.replace(/texture2D/g,"texture"),i=i.replace(/texture3D/g,"texture"),this.userTextures=x.default.getUserSamplers(s),this.shaderProgram=this.gl.createProgram();var l=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(l,`#version 300 es
                                      const vec2 halfmad = vec2(0.5);
                                      in vec2 aPos;
                                      in vec4 aCompColor;
                                      out vec2 vUv;
                                      out vec4 vColor;
                                      void main(void) {
                                        gl_Position = vec4(aPos, 0.0, 1.0);
                                        vUv = aPos * halfmad + halfmad;
                                        vColor = aCompColor;
                                      }`),this.gl.compileShader(l);var n=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(n,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      precision mediump sampler3D;

                                      vec3 lum(vec3 v){
                                          return vec3(dot(v, vec3(0.32,0.49,0.29)));
                                      }

                                      in vec2 vUv;
                                      in vec4 vColor;
                                      out vec4 fragColor;
                                      uniform sampler2D sampler_main;
                                      uniform sampler2D sampler_fw_main;
                                      uniform sampler2D sampler_fc_main;
                                      uniform sampler2D sampler_pw_main;
                                      uniform sampler2D sampler_pc_main;
                                      uniform sampler2D sampler_blur1;
                                      uniform sampler2D sampler_blur2;
                                      uniform sampler2D sampler_blur3;
                                      uniform sampler2D sampler_noise_lq;
                                      uniform sampler2D sampler_noise_lq_lite;
                                      uniform sampler2D sampler_noise_mq;
                                      uniform sampler2D sampler_noise_hq;
                                      uniform sampler2D sampler_pw_noise_lq;
                                      uniform sampler3D sampler_noisevol_lq;
                                      uniform sampler3D sampler_noisevol_hq;

                                      uniform float time;
                                      uniform float gammaAdj;
                                      uniform float echo_zoom;
                                      uniform float echo_alpha;
                                      uniform float echo_orientation;
                                      uniform int invert;
                                      uniform int brighten;
                                      uniform int darken;
                                      uniform int solarize;
                                      uniform vec2 resolution;
                                      uniform vec4 aspect;
                                      uniform vec4 texsize;
                                      uniform vec4 texsize_noise_lq;
                                      uniform vec4 texsize_noise_mq;
                                      uniform vec4 texsize_noise_hq;
                                      uniform vec4 texsize_noise_lq_lite;
                                      uniform vec4 texsize_noisevol_lq;
                                      uniform vec4 texsize_noisevol_hq;

                                      uniform float bass;
                                      uniform float mid;
                                      uniform float treb;
                                      uniform float vol;
                                      uniform float bass_att;
                                      uniform float mid_att;
                                      uniform float treb_att;
                                      uniform float vol_att;

                                      uniform float frame;
                                      uniform float fps;

                                      uniform vec4 _qa;
                                      uniform vec4 _qb;
                                      uniform vec4 _qc;
                                      uniform vec4 _qd;
                                      uniform vec4 _qe;
                                      uniform vec4 _qf;
                                      uniform vec4 _qg;
                                      uniform vec4 _qh;

                                      #define q1 _qa.x
                                      #define q2 _qa.y
                                      #define q3 _qa.z
                                      #define q4 _qa.w
                                      #define q5 _qb.x
                                      #define q6 _qb.y
                                      #define q7 _qb.z
                                      #define q8 _qb.w
                                      #define q9 _qc.x
                                      #define q10 _qc.y
                                      #define q11 _qc.z
                                      #define q12 _qc.w
                                      #define q13 _qd.x
                                      #define q14 _qd.y
                                      #define q15 _qd.z
                                      #define q16 _qd.w
                                      #define q17 _qe.x
                                      #define q18 _qe.y
                                      #define q19 _qe.z
                                      #define q20 _qe.w
                                      #define q21 _qf.x
                                      #define q22 _qf.y
                                      #define q23 _qf.z
                                      #define q24 _qf.w
                                      #define q25 _qg.x
                                      #define q26 _qg.y
                                      #define q27 _qg.z
                                      #define q28 _qg.w
                                      #define q29 _qh.x
                                      #define q30 _qh.y
                                      #define q31 _qh.z
                                      #define q32 _qh.w

                                      uniform vec4 slow_roam_cos;
                                      uniform vec4 roam_cos;
                                      uniform vec4 slow_roam_sin;
                                      uniform vec4 roam_sin;

                                      uniform float blur1_min;
                                      uniform float blur1_max;
                                      uniform float blur2_min;
                                      uniform float blur2_max;
                                      uniform float blur3_min;
                                      uniform float blur3_max;

                                      uniform float scale1;
                                      uniform float scale2;
                                      uniform float scale3;
                                      uniform float bias1;
                                      uniform float bias2;
                                      uniform float bias3;

                                      uniform vec4 rand_frame;
                                      uniform vec4 rand_preset;

                                      uniform float fShader;

                                      float PI = `).concat(Math.PI,`;

                                      `).concat(s,`

                                      void main(void) {
                                        vec3 ret;
                                        vec2 uv = vUv;
                                        vec2 uv_orig = vUv;
                                        uv.y = 1.0 - uv.y;
                                        uv_orig.y = 1.0 - uv_orig.y;
                                        float rad = length(uv - 0.5);
                                        float ang = atan(uv.x - 0.5, uv.y - 0.5);
                                        vec3 hue_shader = vColor.rgb;

                                        `).concat(i,`

                                        fragColor = vec4(ret, vColor.a);
                                      }`)),this.gl.compileShader(n),this.gl.attachShader(this.shaderProgram,l),this.gl.attachShader(this.shaderProgram,n),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.compColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aCompColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.gammaAdjLoc=this.gl.getUniformLocation(this.shaderProgram,"gammaAdj"),this.echoZoomLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_zoom"),this.echoAlphaLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_alpha"),this.echoOrientationLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_orientation"),this.invertLoc=this.gl.getUniformLocation(this.shaderProgram,"invert"),this.brightenLoc=this.gl.getUniformLocation(this.shaderProgram,"brighten"),this.darkenLoc=this.gl.getUniformLocation(this.shaderProgram,"darken"),this.solarizeLoc=this.gl.getUniformLocation(this.shaderProgram,"solarize"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.fShaderLoc=this.gl.getUniformLocation(this.shaderProgram,"fShader"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(var o=0;o<this.userTextures.length;o++){var r=this.userTextures[o];r.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_".concat(r.sampler))}}},{key:"updateShader",value:function(t){this.createShader(t)}},{key:"bindBlurVals",value:function(t,i){var s=t[0],a=t[1],l=t[2],n=i[0],o=i[1],r=i[2],d=n-s,P=s,E=o-a,v=a,b=r-l,U=l;this.gl.uniform1f(this.blur1MinLoc,s),this.gl.uniform1f(this.blur1MaxLoc,n),this.gl.uniform1f(this.blur2MinLoc,a),this.gl.uniform1f(this.blur2MaxLoc,o),this.gl.uniform1f(this.blur3MinLoc,l),this.gl.uniform1f(this.blur3MaxLoc,r),this.gl.uniform1f(this.scale1Loc,d),this.gl.uniform1f(this.scale2Loc,E),this.gl.uniform1f(this.scale3Loc,b),this.gl.uniform1f(this.bias1Loc,P),this.gl.uniform1f(this.bias2Loc,v),this.gl.uniform1f(this.bias3Loc,U)}},{key:"generateCompColors",value:function(t,i,s){for(var a=h.generateHueBase(i),l=this.compWidth+1,n=this.compHeight+1,o=new Float32Array(l*n*4),r=0,d=0;d<n;d++)for(var P=0;P<l;P++){for(var E=P/this.compWidth,v=d/this.compHeight,b=[1,1,1],U=0;U<3;U++)b[U]=a[0+U]*E*v+a[3+U]*(1-E)*v+a[6+U]*E*(1-v)+a[9+U]*(1-E)*(1-v);var D=1;if(t){E*=this.mesh_width+1,v*=this.mesh_height+1,E=Math.clamp(E,0,this.mesh_width-1),v=Math.clamp(v,0,this.mesh_height-1);var C=Math.floor(E),w=Math.floor(v),L=E-C,A=v-w,f=s[(w*(this.mesh_width+1)+C)*4+3],g=s[(w*(this.mesh_width+1)+(C+1))*4+3],m=s[((w+1)*(this.mesh_width+1)+C)*4+3],B=s[((w+1)*(this.mesh_width+1)+(C+1))*4+3];D=f*(1-L)*(1-A)+g*L*(1-A)+m*(1-L)*A+B*L*A}o[r+0]=b[0],o[r+1]=b[1],o[r+2]=b[2],o[r+3]=D,r+=4}return o}},{key:"renderQuadTexture",value:function(t,i,s,a,l,n,o,r,d){var P=this.generateCompColors(t,r,d);this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.compColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,P,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.compColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.compColorLocation);var E=r.wrap!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,E),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,E),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,l),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(var v=0;v<this.userTextures.length;v++){var b=this.userTextures[v];this.gl.activeTexture(this.gl.TEXTURE15+v),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(b.sampler)),this.gl.uniform1i(b.textureLoc,15+v)}this.gl.uniform1f(this.timeLoc,r.time),this.gl.uniform1f(this.gammaAdjLoc,r.gammaadj),this.gl.uniform1f(this.echoZoomLoc,r.echo_zoom),this.gl.uniform1f(this.echoAlphaLoc,r.echo_alpha),this.gl.uniform1f(this.echoOrientationLoc,r.echo_orient),this.gl.uniform1i(this.invertLoc,r.invert),this.gl.uniform1i(this.brightenLoc,r.brighten),this.gl.uniform1i(this.darkenLoc,r.darken),this.gl.uniform1i(this.solarizeLoc,r.solarize),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,r.bass),this.gl.uniform1f(this.midLoc,r.mid),this.gl.uniform1f(this.trebLoc,r.treb),this.gl.uniform1f(this.volLoc,(r.bass+r.mid+r.treb)/3),this.gl.uniform1f(this.bassAttLoc,r.bass_att),this.gl.uniform1f(this.midAttLoc,r.mid_att),this.gl.uniform1f(this.trebAttLoc,r.treb_att),this.gl.uniform1f(this.volAttLoc,(r.bass_att+r.mid_att+r.treb_att)/3),this.gl.uniform1f(this.frameLoc,r.frame),this.gl.uniform1f(this.fpsLoc,r.fps),this.gl.uniform4fv(this.randPresetLoc,r.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform1f(this.fShaderLoc,r.fshader),this.gl.uniform4fv(this.qaLoc,new Float32Array([r.q1||0,r.q2||0,r.q3||0,r.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([r.q5||0,r.q6||0,r.q7||0,r.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([r.q9||0,r.q10||0,r.q11||0,r.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([r.q13||0,r.q14||0,r.q15||0,r.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([r.q17||0,r.q18||0,r.q19||0,r.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([r.q21||0,r.q22||0,r.q23||0,r.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([r.q25||0,r.q26||0,r.q27||0,r.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([r.q29||0,r.q30||0,r.q31||0,r.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(r.time*.005),.5+.5*Math.cos(r.time*.008),.5+.5*Math.cos(r.time*.013),.5+.5*Math.cos(r.time*.022)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(r.time*.3),.5+.5*Math.cos(r.time*1.3),.5+.5*Math.cos(r.time*5),.5+.5*Math.cos(r.time*20)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(r.time*.005),.5+.5*Math.sin(r.time*.008),.5+.5*Math.sin(r.time*.013),.5+.5*Math.sin(r.time*.022)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(r.time*.3),.5+.5*Math.sin(r.time*1.3),.5+.5*Math.sin(r.time*5),.5+.5*Math.sin(r.time*20)]),this.bindBlurVals(n,o),t?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),t||this.gl.enable(this.gl.BLEND)}}],[{key:"generateHueBase",value:function(t){for(var i=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1]),s=0;s<4;s++){i[s*3+0]=.6+.3*Math.sin(t.time*30*.0143+3+s*21+t.rand_start[3]),i[s*3+1]=.6+.3*Math.sin(t.time*30*.0107+1+s*13+t.rand_start[1]),i[s*3+2]=.6+.3*Math.sin(t.time*30*.0129+6+s*9+t.rand_start[2]);for(var a=Math.max(i[s*3],i[s*3+1],i[s*3+2]),l=0;l<3;l++)i[s*3+l]=i[s*3+l]/a,i[s*3+l]=.5+.5*i[s*3+l]}return i}}]),h})()}),"./src/rendering/shaders/output.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e,t){_(this,h),this.gl=e,this.textureRatio=t.textureRatio,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.useFXAA()?this.createFXAAShader():this.createShader()}return T(h,[{key:"useFXAA",value:function(){return this.textureRatio<=1}},{key:"updateGlobals",value:function(t){this.textureRatio=t.textureRatio,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.gl.deleteProgram(this.shaderProgram),this.useFXAA()?this.createFXAAShader():this.createShader()}},{key:"createFXAAShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 v_rgbM;
       out vec2 v_rgbNW;
       out vec2 v_rgbNE;
       out vec2 v_rgbSW;
       out vec2 v_rgbSE;
       uniform vec4 texsize;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);

         v_rgbM = aPos * halfmad + halfmad;
         v_rgbNW = v_rgbM + (vec2(-1.0, -1.0) * texsize.zx);
         v_rgbNE = v_rgbM + (vec2(1.0, -1.0) * texsize.zx);
         v_rgbSW = v_rgbM + (vec2(-1.0, 1.0) * texsize.zx);
         v_rgbSE = v_rgbM + (vec2(1.0, 1.0) * texsize.zx);
       }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
       precision `.concat(this.floatPrecision,` float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 v_rgbM;
       in vec2 v_rgbNW;
       in vec2 v_rgbNE;
       in vec2 v_rgbSW;
       in vec2 v_rgbSE;
       out vec4 fragColor;
       uniform vec4 texsize;
       uniform sampler2D uTexture;

       #ifndef FXAA_REDUCE_MIN
         #define FXAA_REDUCE_MIN   (1.0/ 128.0)
       #endif
       #ifndef FXAA_REDUCE_MUL
         #define FXAA_REDUCE_MUL   (1.0 / 8.0)
       #endif
       #ifndef FXAA_SPAN_MAX
         #define FXAA_SPAN_MAX     8.0
       #endif

       void main(void) {
         vec4 color;
         vec3 rgbNW = textureLod(uTexture, v_rgbNW, 0.0).xyz;
         vec3 rgbNE = textureLod(uTexture, v_rgbNE, 0.0).xyz;
         vec3 rgbSW = textureLod(uTexture, v_rgbSW, 0.0).xyz;
         vec3 rgbSE = textureLod(uTexture, v_rgbSE, 0.0).xyz;
         vec3 rgbM  = textureLod(uTexture, v_rgbM, 0.0).xyz;
         vec3 luma = vec3(0.299, 0.587, 0.114);
         float lumaNW = dot(rgbNW, luma);
         float lumaNE = dot(rgbNE, luma);
         float lumaSW = dot(rgbSW, luma);
         float lumaSE = dot(rgbSE, luma);
         float lumaM  = dot(rgbM,  luma);
         float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
         float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

         mediump vec2 dir;
         dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
         dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

         float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                               (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

         float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
         dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
                   max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                   dir * rcpDirMin)) * texsize.zw;

         vec3 rgbA = 0.5 * (
             textureLod(uTexture, v_rgbM + dir * (1.0 / 3.0 - 0.5), 0.0).xyz +
             textureLod(uTexture, v_rgbM + dir * (2.0 / 3.0 - 0.5), 0.0).xyz);
         vec3 rgbB = rgbA * 0.5 + 0.25 * (
             textureLod(uTexture, v_rgbM + dir * -0.5, 0.0).xyz +
             textureLod(uTexture, v_rgbM + dir * 0.5, 0.0).xyz);

         float lumaB = dot(rgbB, luma);
         if ((lumaB < lumaMin) || (lumaB > lumaMax))
           color = vec4(rgbA, 1.0);
         else
           color = vec4(rgbB, 1.0);

         fragColor = color;
       }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize")}},{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv = aPos * halfmad + halfmad;
       }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
       precision `.concat(this.floatPrecision,` float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;

       void main(void) {
         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);
       }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}},{key:"renderQuadTexture",value:function(t){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0),this.useFXAA()&&this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}]),h})()}),"./src/rendering/shaders/resample.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e){_(this,h),this.gl=e,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader()}return T(h,[{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv = aPos * halfmad + halfmad;
       }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
       precision `.concat(this.floatPrecision,` float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;

       void main(void) {
         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);
       }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}},{key:"renderQuadTexture",value:function(t){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.uniform1i(this.textureLoc,0),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}]),h})()}),"./src/rendering/shaders/shaderUtils.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return h});function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function p(e,t,i){return t&&_(e.prototype,t),i&&_(e,i),e}var T=/uniform sampler2D sampler_(?:.+?);/g,u=/uniform sampler2D sampler_(.+?);/,h=(function(){function e(){x(this,e)}return p(e,null,[{key:"getShaderParts",value:function(i){var s=i.indexOf("shader_body");if(i&&s>-1){var a=i.substring(0,s),l=i.substring(s),n=l.indexOf("{"),o=l.lastIndexOf("}"),r=l.substring(n+1,o);return[a,r]}return["",i]}},{key:"getFragmentFloatPrecision",value:function(i){return i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0?"highp":i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}},{key:"getUserSamplers",value:function(i){var s=[],a=i.match(T);if(a&&a.length>0)for(var l=0;l<a.length;l++){var n=a[l].match(u);if(n&&n.length>0){var o=n[1];s.push({sampler:o})}}return s}}]),e})()}),"./src/rendering/shaders/warp.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e,t,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};_(this,h),this.gl=e,this.noise=t,this.image=i,this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.warpUvVertexBuf=this.gl.createBuffer(),this.warpColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),e.samplerParameteri(this.mainSampler,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}return T(h,[{key:"buildPositions",value:function(){for(var t=2,i=2,s=t/2,a=i/2,l=this.mesh_width,n=this.mesh_height,o=l+1,r=n+1,d=t/l,P=i/n,E=[],v=0;v<r;v++)for(var b=v*P-a,U=0;U<o;U++){var D=U*d-s;E.push(D,-b,0)}for(var C=[],w=0;w<n;w++)for(var L=0;L<l;L++){var A=L+o*w,f=L+o*(w+1),g=L+1+o*(w+1),m=L+1+o*w;C.push(A,f,m),C.push(f,g,m)}this.vertices=new Float32Array(E),this.indices=new Uint16Array(C)}},{key:"updateGlobals",value:function(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}},{key:"createShader",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i,s;if(t.length===0)i="ret = texture(sampler_main, uv).rgb * decay;",s="";else{var a=x.default.getShaderParts(t);s=a[0],i=a[1]}i=i.replace(/texture2D/g,"texture"),i=i.replace(/texture3D/g,"texture"),this.userTextures=x.default.getUserSamplers(s),this.shaderProgram=this.gl.createProgram();var l=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(l,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      const vec2 halfmad = vec2(0.5);
                                      in vec2 aPos;
                                      in vec2 aWarpUv;
                                      in vec4 aWarpColor;
                                      out vec2 uv;
                                      out vec2 uv_orig;
                                      out vec4 vColor;
                                      void main(void) {
                                        gl_Position = vec4(aPos, 0.0, 1.0);
                                        uv_orig = aPos * halfmad + halfmad;
                                        uv = aWarpUv;
                                        vColor = aWarpColor;
                                      }`)),this.gl.compileShader(l);var n=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(n,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      precision mediump sampler3D;

                                      in vec2 uv;
                                      in vec2 uv_orig;
                                      in vec4 vColor;
                                      out vec4 fragColor;
                                      uniform sampler2D sampler_main;
                                      uniform sampler2D sampler_fw_main;
                                      uniform sampler2D sampler_fc_main;
                                      uniform sampler2D sampler_pw_main;
                                      uniform sampler2D sampler_pc_main;
                                      uniform sampler2D sampler_blur1;
                                      uniform sampler2D sampler_blur2;
                                      uniform sampler2D sampler_blur3;
                                      uniform sampler2D sampler_noise_lq;
                                      uniform sampler2D sampler_noise_lq_lite;
                                      uniform sampler2D sampler_noise_mq;
                                      uniform sampler2D sampler_noise_hq;
                                      uniform sampler2D sampler_pw_noise_lq;
                                      uniform sampler3D sampler_noisevol_lq;
                                      uniform sampler3D sampler_noisevol_hq;
                                      uniform float time;
                                      uniform float decay;
                                      uniform vec2 resolution;
                                      uniform vec4 aspect;
                                      uniform vec4 texsize;
                                      uniform vec4 texsize_noise_lq;
                                      uniform vec4 texsize_noise_mq;
                                      uniform vec4 texsize_noise_hq;
                                      uniform vec4 texsize_noise_lq_lite;
                                      uniform vec4 texsize_noisevol_lq;
                                      uniform vec4 texsize_noisevol_hq;

                                      uniform float bass;
                                      uniform float mid;
                                      uniform float treb;
                                      uniform float vol;
                                      uniform float bass_att;
                                      uniform float mid_att;
                                      uniform float treb_att;
                                      uniform float vol_att;

                                      uniform float frame;
                                      uniform float fps;

                                      uniform vec4 _qa;
                                      uniform vec4 _qb;
                                      uniform vec4 _qc;
                                      uniform vec4 _qd;
                                      uniform vec4 _qe;
                                      uniform vec4 _qf;
                                      uniform vec4 _qg;
                                      uniform vec4 _qh;

                                      #define q1 _qa.x
                                      #define q2 _qa.y
                                      #define q3 _qa.z
                                      #define q4 _qa.w
                                      #define q5 _qb.x
                                      #define q6 _qb.y
                                      #define q7 _qb.z
                                      #define q8 _qb.w
                                      #define q9 _qc.x
                                      #define q10 _qc.y
                                      #define q11 _qc.z
                                      #define q12 _qc.w
                                      #define q13 _qd.x
                                      #define q14 _qd.y
                                      #define q15 _qd.z
                                      #define q16 _qd.w
                                      #define q17 _qe.x
                                      #define q18 _qe.y
                                      #define q19 _qe.z
                                      #define q20 _qe.w
                                      #define q21 _qf.x
                                      #define q22 _qf.y
                                      #define q23 _qf.z
                                      #define q24 _qf.w
                                      #define q25 _qg.x
                                      #define q26 _qg.y
                                      #define q27 _qg.z
                                      #define q28 _qg.w
                                      #define q29 _qh.x
                                      #define q30 _qh.y
                                      #define q31 _qh.z
                                      #define q32 _qh.w

                                      uniform vec4 slow_roam_cos;
                                      uniform vec4 roam_cos;
                                      uniform vec4 slow_roam_sin;
                                      uniform vec4 roam_sin;

                                      uniform float blur1_min;
                                      uniform float blur1_max;
                                      uniform float blur2_min;
                                      uniform float blur2_max;
                                      uniform float blur3_min;
                                      uniform float blur3_max;

                                      uniform float scale1;
                                      uniform float scale2;
                                      uniform float scale3;
                                      uniform float bias1;
                                      uniform float bias2;
                                      uniform float bias3;

                                      uniform vec4 rand_frame;
                                      uniform vec4 rand_preset;

                                      float PI = `).concat(Math.PI,`;

                                      `).concat(s,`

                                      void main(void) {
                                        vec3 ret;
                                        float rad = length(uv_orig - 0.5);
                                        float ang = atan(uv_orig.x - 0.5, uv_orig.y - 0.5);

                                        `).concat(i,`

                                        fragColor = vec4(ret, 1.0) * vColor;
                                      }`)),this.gl.compileShader(n),this.gl.attachShader(this.shaderProgram,l),this.gl.attachShader(this.shaderProgram,n),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.warpUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpUv"),this.warpColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.decayLoc=this.gl.getUniformLocation(this.shaderProgram,"decay"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(var o=0;o<this.userTextures.length;o++){var r=this.userTextures[o];r.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_".concat(r.sampler))}}},{key:"updateShader",value:function(t){this.createShader(t)}},{key:"bindBlurVals",value:function(t,i){var s=t[0],a=t[1],l=t[2],n=i[0],o=i[1],r=i[2],d=n-s,P=s,E=o-a,v=a,b=r-l,U=l;this.gl.uniform1f(this.blur1MinLoc,s),this.gl.uniform1f(this.blur1MaxLoc,n),this.gl.uniform1f(this.blur2MinLoc,a),this.gl.uniform1f(this.blur2MaxLoc,o),this.gl.uniform1f(this.blur3MinLoc,l),this.gl.uniform1f(this.blur3MaxLoc,r),this.gl.uniform1f(this.scale1Loc,d),this.gl.uniform1f(this.scale2Loc,E),this.gl.uniform1f(this.scale3Loc,b),this.gl.uniform1f(this.bias1Loc,P),this.gl.uniform1f(this.bias2Loc,v),this.gl.uniform1f(this.bias3Loc,U)}},{key:"renderQuadTexture",value:function(t,i,s,a,l,n,o,r,d,P){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpUvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,d,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,P,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpColorLocation);var E=r.wrap!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,E),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,E),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,l),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(var v=0;v<this.userTextures.length;v++){var b=this.userTextures[v];this.gl.activeTexture(this.gl.TEXTURE15+v),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(b.sampler)),this.gl.uniform1i(b.textureLoc,15+v)}this.gl.uniform1f(this.decayLoc,r.decay),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,[this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY]),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,r.bass),this.gl.uniform1f(this.midLoc,r.mid),this.gl.uniform1f(this.trebLoc,r.treb),this.gl.uniform1f(this.volLoc,(r.bass+r.mid+r.treb)/3),this.gl.uniform1f(this.bassAttLoc,r.bass_att),this.gl.uniform1f(this.midAttLoc,r.mid_att),this.gl.uniform1f(this.trebAttLoc,r.treb_att),this.gl.uniform1f(this.volAttLoc,(r.bass_att+r.mid_att+r.treb_att)/3),this.gl.uniform1f(this.timeLoc,r.time),this.gl.uniform1f(this.frameLoc,r.frame),this.gl.uniform1f(this.fpsLoc,r.fps),this.gl.uniform4fv(this.randPresetLoc,r.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform4fv(this.qaLoc,new Float32Array([r.q1||0,r.q2||0,r.q3||0,r.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([r.q5||0,r.q6||0,r.q7||0,r.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([r.q9||0,r.q10||0,r.q11||0,r.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([r.q13||0,r.q14||0,r.q15||0,r.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([r.q17||0,r.q18||0,r.q19||0,r.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([r.q21||0,r.q22||0,r.q23||0,r.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([r.q25||0,r.q26||0,r.q27||0,r.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([r.q29||0,r.q30||0,r.q31||0,r.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(r.time*.005),.5+.5*Math.cos(r.time*.008),.5+.5*Math.cos(r.time*.013),.5+.5*Math.cos(r.time*.022)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(r.time*.3),.5+.5*Math.cos(r.time*1.3),.5+.5*Math.cos(r.time*5),.5+.5*Math.cos(r.time*20)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(r.time*.005),.5+.5*Math.sin(r.time*.008),.5+.5*Math.sin(r.time*.013),.5+.5*Math.sin(r.time*.022)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(r.time*.3),.5+.5*Math.sin(r.time*1.3),.5+.5*Math.sin(r.time*5),.5+.5*Math.sin(r.time*20)]),this.bindBlurVals(n,o),t?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),t||this.gl.enable(this.gl.BLEND)}}]),h})()}),"./src/rendering/shapes/customShape.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return h});var x=c("./src/utils.js"),_=c("./src/rendering/shaders/shaderUtils.js");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e,t,i){return t&&T(e.prototype,t),i&&T(e,i),e}var h=(function(){function e(t,i,s){p(this,e),this.index=t,this.gl=i;var a=101;this.positions=new Float32Array((a+2)*3),this.colors=new Float32Array((a+2)*4),this.uvs=new Float32Array((a+2)*2),this.borderPositions=new Float32Array((a+1)*3),this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.uvVertexBuf=this.gl.createBuffer(),this.borderPositionVertexBuf=this.gl.createBuffer(),this.floatPrecision=_.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.createBorderShader(),this.mainSampler=this.gl.createSampler(),i.samplerParameteri(this.mainSampler,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_LINEAR),i.samplerParameteri(this.mainSampler,i.TEXTURE_MAG_FILTER,i.LINEAR),i.samplerParameteri(this.mainSampler,i.TEXTURE_WRAP_S,i.REPEAT),i.samplerParameteri(this.mainSampler,i.TEXTURE_WRAP_T,i.REPEAT)}return u(e,[{key:"updateGlobals",value:function(i){this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}},{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,`#version 300 es
                                      in vec3 aPos;
                                      in vec4 aColor;
                                      in vec2 aUv;
                                      out vec4 vColor;
                                      out vec2 vUv;
                                      void main(void) {
                                        vColor = aColor;
                                        vUv = aUv;
                                        gl_Position = vec4(aPos, 1.0);
                                      }`),this.gl.compileShader(i);var s=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(s,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      uniform sampler2D uTexture;
                                      uniform float uTextured;
                                      in vec4 vColor;
                                      in vec2 vUv;
                                      out vec4 fragColor;
                                      void main(void) {
                                        if (uTextured != 0.0) {
                                          fragColor = texture(uTexture, vUv) * vColor;
                                        } else {
                                          fragColor = vColor;
                                        }
                                      }`)),this.gl.compileShader(s),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,s),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.aUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.texturedLoc=this.gl.getUniformLocation(this.shaderProgram,"uTextured"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}},{key:"createBorderShader",value:function(){this.borderShaderProgram=this.gl.createProgram();var i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,`#version 300 es
                                      in vec3 aBorderPos;
                                      uniform vec2 thickOffset;
                                      void main(void) {
                                        gl_Position = vec4(aBorderPos +
                                                           vec3(thickOffset, 0.0), 1.0);
                                      }`),this.gl.compileShader(i);var s=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(s,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      out vec4 fragColor;
                                      uniform vec4 uBorderColor;
                                      void main(void) {
                                        fragColor = uBorderColor;
                                      }`)),this.gl.compileShader(s),this.gl.attachShader(this.borderShaderProgram,i),this.gl.attachShader(this.borderShaderProgram,s),this.gl.linkProgram(this.borderShaderProgram),this.aBorderPosLoc=this.gl.getAttribLocation(this.borderShaderProgram,"aBorderPos"),this.uBorderColorLoc=this.gl.getUniformLocation(this.borderShaderProgram,"uBorderColor"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}},{key:"drawCustomShape",value:function(i,s,a,l,n){if(l.baseVals.enabled!==0){this.setupShapeBuffers(a.mdVSFrame);for(var o=Object.assign({},a.mdVSShapes[this.index],a.mdVSFrameMapShapes[this.index],a.mdVSQAfterFrame,a.mdVSTShapeInits[this.index],s),r=x.default.cloneVars(o),d=Math.clamp(o.num_inst,1,1024),P=0;P<d;P++){o.instance=P,o.x=r.x,o.y=r.y,o.rad=r.rad,o.ang=r.ang,o.r=r.r,o.g=r.g,o.b=r.b,o.a=r.a,o.r2=r.r2,o.g2=r.g2,o.b2=r.b2,o.a2=r.a2,o.border_r=r.border_r,o.border_g=r.border_g,o.border_b=r.border_b,o.border_a=r.border_a,o.thickoutline=r.thickoutline,o.textured=r.textured,o.tex_zoom=r.tex_zoom,o.tex_ang=r.tex_ang,o.additive=r.additive;var E=l.frame_eqs(o),v=E.sides;v=Math.clamp(v,3,100),v=Math.floor(v);var b=E.rad,U=E.ang,D=E.x*2-1,C=E.y*-2+1,w=E.r,L=E.g,A=E.b,f=E.a,g=E.r2,m=E.g2,B=E.b2,R=E.a2,q=E.border_r,y=E.border_g,I=E.border_b,F=E.border_a;this.borderColor=[q,y,I,F*i];var W=E.thickoutline,H=E.textured,N=E.tex_zoom,k=E.tex_ang,G=E.additive,it=this.borderColor[3]>0,Z=Math.abs(H)>=1,Q=Math.abs(W)>=1,K=Math.abs(G)>=1;this.positions[0]=D,this.positions[1]=C,this.positions[2]=0,this.colors[0]=w,this.colors[1]=L,this.colors[2]=A,this.colors[3]=f*i,Z&&(this.uvs[0]=.5,this.uvs[1]=.5);for(var X=Math.PI*.25,O=1;O<=v+1;O++){var J=(O-1)/v,st=J*2*Math.PI,et=st+U+X;if(this.positions[O*3+0]=D+b*Math.cos(et)*this.aspecty,this.positions[O*3+1]=C+b*Math.sin(et),this.positions[O*3+2]=0,this.colors[O*4+0]=g,this.colors[O*4+1]=m,this.colors[O*4+2]=B,this.colors[O*4+3]=R*i,Z){var Y=st+k+X;this.uvs[O*2+0]=.5+.5*Math.cos(Y)/N*this.aspecty,this.uvs[O*2+1]=.5+.5*Math.sin(Y)/N}it&&(this.borderPositions[(O-1)*3+0]=this.positions[O*3+0],this.borderPositions[(O-1)*3+1]=this.positions[O*3+1],this.borderPositions[(O-1)*3+2]=this.positions[O*3+2])}this.mdVSShapeFrame=E,this.drawCustomShapeInstance(n,v,Z,it,Q,K)}var V=a.mdVSUserKeysShapes[this.index],at=x.default.pick(this.mdVSShapeFrame,V);a.mdVSFrameMapShapes[this.index]=at}}},{key:"setupShapeBuffers",value:function(i){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.uvs,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.borderPositions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc);var s=i.wrap!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,s),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,s)}},{key:"drawCustomShapeInstance",value:function(i,s,a,l,n,o){this.gl.useProgram(this.shaderProgram);var r=new Float32Array(this.positions.buffer,0,(s+2)*3);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,r),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation);var d=new Float32Array(this.colors.buffer,0,(s+2)*4);if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,d),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),a){var P=new Float32Array(this.uvs.buffer,0,(s+2)*2);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,P),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation)}if(this.gl.uniform1f(this.texturedLoc,a?1:0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),o?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,s+2),l){this.gl.useProgram(this.borderShaderProgram);var E=new Float32Array(this.borderPositions.buffer,0,(s+1)*3);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,E),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc),this.gl.uniform4fv(this.uBorderColorLoc,this.borderColor);for(var v=n?4:1,b=0;b<v;b++){var U=2;b===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):b===1?this.gl.uniform2fv(this.thickOffsetLoc,[U/this.texsizeX,0]):b===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,U/this.texsizeY]):b===3&&this.gl.uniform2fv(this.thickOffsetLoc,[U/this.texsizeX,U/this.texsizeY]),this.gl.drawArrays(this.gl.LINE_STRIP,0,s+1)}}}}]),e})()}),"./src/rendering/sprites/border.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_(this,h),this.gl=e,this.positions=new Float32Array(72),this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}return T(h,[{key:"updateGlobals",value:function(t){this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}},{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
                                      in vec3 aPos;
                                      void main(void) {
                                        gl_Position = vec4(aPos, 1.0);
                                      }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      out vec4 fragColor;
                                      uniform vec4 u_color;
                                      void main(void) {
                                        fragColor = u_color;
                                      }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}},{key:"addTriangle",value:function(t,i,s,a){this.positions[t+0]=i[0],this.positions[t+1]=i[1],this.positions[t+2]=i[2],this.positions[t+3]=s[0],this.positions[t+4]=s[1],this.positions[t+5]=s[2],this.positions[t+6]=a[0],this.positions[t+7]=a[1],this.positions[t+8]=a[2]}},{key:"generateBorder",value:function(t,i,s){if(i>0&&t[3]>0){var a=2,l=2,n=a/2,o=l/2,r=s/2,d=i/2+r,P=r*a,E=r*l,v=d*a,b=d*l,U=[-n+P,-o+b,0],D=[-n+P,o-b,0],C=[-n+v,o-b,0],w=[-n+v,-o+b,0];return this.addTriangle(0,w,D,U),this.addTriangle(9,w,C,D),U=[n-P,-o+b,0],D=[n-P,o-b,0],C=[n-v,o-b,0],w=[n-v,-o+b,0],this.addTriangle(18,U,D,w),this.addTriangle(27,D,C,w),U=[-n+P,-o+E,0],D=[-n+P,b-o,0],C=[n-P,b-o,0],w=[n-P,-o+E,0],this.addTriangle(36,w,D,U),this.addTriangle(45,w,C,D),U=[-n+P,o-E,0],D=[-n+P,o-b,0],C=[n-P,o-b,0],w=[n-P,o-E,0],this.addTriangle(54,U,D,w),this.addTriangle(63,D,C,w),!0}return!1}},{key:"drawBorder",value:function(t,i,s){this.generateBorder(t,i,s)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,t),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLES,0,this.positions.length/3))}}]),h})()}),"./src/rendering/sprites/darkenCenter.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e,t){_(this,h),this.gl=e,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions(),this.colors=new Float32Array([0,0,0,3/32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader()}return T(h,[{key:"updateGlobals",value:function(t){this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions()}},{key:"generatePositions",value:function(){var t=.05;this.positions=new Float32Array([0,0,0,-t*this.aspecty,0,0,0,-t,0,t*this.aspecty,0,0,0,t,0,-t*this.aspecty,0,0])}},{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
                                      in vec3 aPos;
                                      in vec4 aColor;
                                      out vec4 vColor;
                                      void main(void) {
                                        vColor = aColor;
                                        gl_Position = vec4(aPos, 1.0);
                                      }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      in vec4 vColor;
                                      out vec4 fragColor;
                                      void main(void) {
                                        fragColor = vColor;
                                      }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor")}},{key:"drawDarkenCenter",value:function(t){t.darken_center!==0&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,this.positions.length/3))}}]),h})()}),"./src/rendering/text/titleText.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return u});var x=c("./src/rendering/shaders/shaderUtils.js");function _(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function p(h,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(h,i.key,i)}}function T(h,e,t){return e&&p(h.prototype,e),t&&p(h,t),h}var u=(function(){function h(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_(this,h),this.gl=e,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.textTexture=this.gl.createTexture(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.vertexBuf=this.gl.createBuffer(),this.canvas=document.createElement("canvas"),this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY,this.context2D=this.canvas.getContext("2d"),this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader()}return T(h,[{key:"generateTitleTexture",value:function(t){this.context2D.clearRect(0,0,this.texsizeX,this.texsizeY),this.fontSize=Math.floor(16*(this.texsizeX/256)),this.fontSize=Math.max(this.fontSize,6),this.context2D.font="italic ".concat(this.fontSize,"px Times New Roman");var i=t,s=this.context2D.measureText(i).width;if(s>this.texsizeX){var a=.91*(this.texsizeX/s);i="".concat(i.substring(0,Math.floor(i.length*a)),"..."),s=this.context2D.measureText(i).width}this.context2D.fillStyle="#FFFFFF",this.context2D.fillText(i,(this.texsizeX-s)/2,this.texsizeY/2);var l=new Uint8Array(this.context2D.getImageData(0,0,this.texsizeX,this.texsizeY).data.buffer);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,l),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"updateGlobals",value:function(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY}},{key:"buildPositions",value:function(){for(var t=2,i=2,s=t/2,a=i/2,l=15,n=7,o=l+1,r=n+1,d=t/l,P=i/n,E=[],v=0;v<r;v++)for(var b=v*P-a,U=0;U<o;U++){var D=U*d-s;E.push(D,-b,0)}for(var C=[],w=0;w<n;w++)for(var L=0;L<l;L++){var A=L+o*w,f=L+o*(w+1),g=L+1+o*(w+1),m=L+1+o*w;C.push(A,f,m),C.push(f,g,m)}this.vertices=new Float32Array(E),this.indices=new Uint16Array(C)}},{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       in vec2 aUv;
       out vec2 uv_orig;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv_orig = aPos * halfmad + halfmad;
         uv = aUv;
       }`),this.gl.compileShader(t);var i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`#version 300 es
       precision `.concat(this.floatPrecision,` float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv_orig;
       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform float textColor;

       void main(void) {
         fragColor = texture(uTexture, uv) * vec4(textColor);
       }`)),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.uvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.textColorLoc=this.gl.getUniformLocation(this.shaderProgram,"textColor")}},{key:"generateUvs",value:function(t,i,s){for(var a=15,l=7,n=a+1,o=l+1,r=[],d=.75,P=0;P<o;P++)for(var E=0;E<n;E++){var v=E/a,b=(P/l-.5)*d+.5,U=v*2-1,D=b*2-1;t>=1&&(D+=1/this.texsizeY),r.push(U,i?D:-D)}for(var C=Math.max(0,1-t*1.5),w=Math.pow(C,1.8)*1.3,L=0;L<o;L++)for(var A=0;A<n;A++){var f=L*n+A;r[f]+=w*.07*Math.sin(s.time*.31+r[f]*.39-r[f+1]*1.94),r[f]+=w*.044*Math.sin(s.time*.81-r[f]*1.91+r[f+1]*.27),r[f]+=w*.061*Math.sin(s.time*1.31+r[f]*.61+r[f+1]*.74),r[f+1]+=w*.061*Math.sin(s.time*.37+r[f]*1.83+r[f+1]*.69),r[f+1]+=w*.07*Math.sin(s.time*.67+r[f]*.42-r[f+1]*1.39),r[f+1]+=w*.087*Math.sin(s.time*1.07+r[f]*3.55+r[f+1]*.89)}for(var g=1.01/(Math.pow(t,.21)+.01),m=0;m<r.length/2;m++)r[m*2]*=g,r[m*2+1]*=g*this.invAspecty,r[m*2]=(r[m*2]+1)/2,r[m*2+1]=(r[m*2+1]+1)/2;return new Float32Array(r)}},{key:"renderTitle",value:function(t,i,s){this.gl.useProgram(this.shaderProgram);var a=this.generateUvs(t,i,s);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.uvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.uvLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.uniform1i(this.textureLoc,0),this.gl.uniform1f(this.textColorLoc,Math.pow(t,.3)),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0)}}]),h})()}),"./src/rendering/waves/basicWaveform.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return h});var x=c("./src/rendering/shaders/shaderUtils.js"),_=c("./src/rendering/waves/waveUtils.js");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e,t,i){return t&&T(e.prototype,t),i&&T(e,i),e}var h=(function(){function e(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};p(this,e),this.gl=t;var s=512;this.positions=new Float32Array(s*3),this.positions2=new Float32Array(s*3),this.oldPositions=new Float32Array(s*3),this.oldPositions2=new Float32Array(s*3),this.smoothedPositions=new Float32Array((s*2-1)*3),this.smoothedPositions2=new Float32Array((s*2-1)*3),this.color=[0,0,0,1],this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=x.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}return u(e,[{key:"updateGlobals",value:function(i){this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}},{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,`#version 300 es
                                      in vec3 aPos;
                                      uniform vec2 thickOffset;
                                      void main(void) {
                                        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);
                                      }`),this.gl.compileShader(i);var s=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(s,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      out vec4 fragColor;
                                      uniform vec4 u_color;
                                      void main(void) {
                                        fragColor = u_color;
                                      }`)),this.gl.compileShader(s),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,s),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}},{key:"generateWaveform",value:function(i,s,a,l,n){var o=n.wave_a,r=(n.bass+n.mid+n.treb)/3;if(r>-.01&&o>.001&&a.length>0){var d=e.processWaveform(a,n),P=e.processWaveform(l,n),E=Math.floor(n.wave_mode)%8,v=Math.floor(n.old_wave_mode)%8,b=n.wave_x*2-1,U=n.wave_y*2-1;this.numVert=0,this.oldNumVert=0;for(var D=i&&E!==v?2:1,C=0;C<D;C++){var w=C===0?E:v,L=n.wave_mystery;(w===0||w===1||w===4)&&(L<-1||L>1)&&(L=L*.5+.5,L-=Math.floor(L),L=Math.abs(L),L=L*2-1);var A=void 0,f=void 0,g=void 0;if(C===0?(f=this.positions,g=this.positions2):(f=this.oldPositions,g=this.oldPositions2),o=n.wave_a,w===0){if(n.modwavealphabyvolume>0){var m=n.modwavealphaend-n.modwavealphastart;o*=(r-n.modwavealphastart)/m}o=Math.clamp(o,0,1),A=Math.floor(d.length/2)+1;for(var B=1/(A-1),R=Math.floor((d.length-A)/2),q=0;q<A-1;q++){var y=.5+.4*P[q+R]+L,I=q*B*2*Math.PI+n.time*.2;if(q<A/10){var F=q/(A*.1);F=.5-.5*Math.cos(F*Math.PI);var W=.5+.4*P[q+A+R]+L;y=(1-F)*W+y*F}f[q*3+0]=y*Math.cos(I)*this.aspecty+b,f[q*3+1]=y*Math.sin(I)*this.aspectx+U,f[q*3+2]=0}f[(A-1)*3+0]=f[0],f[(A-1)*3+1]=f[1],f[(A-1)*3+2]=0}else if(w===1){if(o*=1.25,n.modwavealphabyvolume>0){var H=n.modwavealphaend-n.modwavealphastart;o*=(r-n.modwavealphastart)/H}o=Math.clamp(o,0,1),A=Math.floor(d.length/2);for(var N=0;N<A;N++){var k=.53+.43*P[N]+L,G=d[N+32]*.5*Math.PI+n.time*2.3;f[N*3+0]=k*Math.cos(G)*this.aspecty+b,f[N*3+1]=k*Math.sin(G)*this.aspectx+U,f[N*3+2]=0}}else if(w===2){if(this.texsizeX<1024?o*=.09:this.texsizeX>=1024&&this.texsizeX<2048?o*=.11:o*=.13,n.modwavealphabyvolume>0){var it=n.modwavealphaend-n.modwavealphastart;o*=(r-n.modwavealphastart)/it}o=Math.clamp(o,0,1),A=d.length;for(var Z=0;Z<d.length;Z++)f[Z*3+0]=P[Z]*this.aspecty+b,f[Z*3+1]=d[(Z+32)%d.length]*this.aspectx+U,f[Z*3+2]=0}else if(w===3){if(this.texsizeX<1024?o*=.15:this.texsizeX>=1024&&this.texsizeX<2048?o*=.22:o*=.33,o*=1.3,o*=n.treb*n.treb,n.modwavealphabyvolume>0){var Q=n.modwavealphaend-n.modwavealphastart;o*=(r-n.modwavealphastart)/Q}o=Math.clamp(o,0,1),A=d.length;for(var K=0;K<d.length;K++)f[K*3+0]=P[K]*this.aspecty+b,f[K*3+1]=d[(K+32)%d.length]*this.aspectx+U,f[K*3+2]=0}else if(w===4){if(n.modwavealphabyvolume>0){var X=n.modwavealphaend-n.modwavealphastart;o*=(r-n.modwavealphastart)/X}o=Math.clamp(o,0,1),A=d.length,A>this.texsizeX/3&&(A=Math.floor(this.texsizeX/3));for(var O=1/A,J=Math.floor((d.length-A)/2),st=.45+.5*(L*.5+.5),et=1-st,Y=0;Y<A;Y++){var V=2*Y*O+(b-1)+P[(Y+25+J)%d.length]*.44,at=d[Y+J]*.47+U;Y>1&&(V=V*et+st*(f[(Y-1)*3+0]*2-f[(Y-2)*3+0]),at=at*et+st*(f[(Y-1)*3+1]*2-f[(Y-2)*3+1])),f[Y*3+0]=V,f[Y*3+1]=at,f[Y*3+2]=0}}else if(w===5){if(this.texsizeX<1024?o*=.09:this.texsizeX>=1024&&this.texsizeX<2048?o*=.11:o*=.13,n.modwavealphabyvolume>0){var ft=n.modwavealphaend-n.modwavealphastart;o*=(r-n.modwavealphastart)/ft}o=Math.clamp(o,0,1);var tt=Math.cos(n.time*.3),ot=Math.sin(n.time*.3);A=d.length;for(var rt=0;rt<d.length;rt++){var lt=(rt+32)%d.length,ht=P[rt]*d[lt]+d[rt]*P[lt],Lt=P[rt]*P[rt]-d[lt]*d[lt];f[rt*3+0]=(ht*tt-Lt*ot)*(this.aspecty+b),f[rt*3+1]=(ht*ot+Lt*tt)*(this.aspectx+U),f[rt*3+2]=0}}else if(w===6||w===7){if(n.modwavealphabyvolume>0){var Yt=n.modwavealphaend-n.modwavealphastart;o*=(r-n.modwavealphastart)/Yt}o=Math.clamp(o,0,1),A=Math.floor(d.length/2),A>this.texsizeX/3&&(A=Math.floor(this.texsizeX/3));for(var Mt=Math.floor((d.length-A)/2),mt=Math.PI*.5*L,gt=Math.cos(mt),ct=Math.sin(mt),$=[b*Math.cos(mt+Math.PI*.5)-gt*3,b*Math.cos(mt+Math.PI*.5)+gt*3],j=[b*Math.sin(mt+Math.PI*.5)-ct*3,b*Math.sin(mt+Math.PI*.5)+ct*3],z=0;z<2;z++)for(var Ut=0;Ut<4;Ut++){var At=void 0,dt=!1;switch(Ut){case 0:$[z]>1.1&&(At=(1.1-$[1-z])/($[z]-$[1-z]),dt=!0);break;case 1:$[z]<-1.1&&(At=(-1.1-$[1-z])/($[z]-$[1-z]),dt=!0);break;case 2:j[z]>1.1&&(At=(1.1-j[1-z])/(j[z]-j[1-z]),dt=!0);break;case 3:j[z]<-1.1&&(At=(-1.1-j[1-z])/(j[z]-j[1-z]),dt=!0);break;default:}if(dt){var It=$[z]-$[1-z],vt=j[z]-j[1-z];$[z]=$[1-z]+It*At,j[z]=j[1-z]+vt*At}}gt=($[1]-$[0])/A,ct=(j[1]-j[0])/A;var te=Math.atan2(ct,gt),jt=Math.cos(te+Math.PI*.5),Gt=Math.sin(te+Math.PI*.5);if(w===6)for(var Tt=0;Tt<A;Tt++){var ee=d[Tt+Mt];f[Tt*3+0]=$[0]+gt*Tt+jt*.25*ee,f[Tt*3+1]=j[0]+ct*Tt+Gt*.25*ee,f[Tt*3+2]=0}else if(w===7){for(var Xt=Math.pow(U*.5+.5,2),Et=0;Et<A;Et++){var ie=d[Et+Mt];f[Et*3+0]=$[0]+gt*Et+jt*(.25*ie+Xt),f[Et*3+1]=j[0]+ct*Et+Gt*(.25*ie+Xt),f[Et*3+2]=0}for(var bt=0;bt<A;bt++){var se=P[bt+Mt];g[bt*3+0]=$[0]+gt*bt+jt*(.25*se-Xt),g[bt*3+1]=j[0]+ct*bt+Gt*(.25*se-Xt),g[bt*3+2]=0}}}C===0?(this.positions=f,this.positions2=g,this.numVert=A,this.alpha=o):(this.oldPositions=f,this.oldPositions2=g,this.oldNumVert=A,this.oldAlpha=o)}var nt=.5-.5*Math.cos(s*Math.PI),ut=1-nt;this.oldNumVert>0&&(o=nt*this.alpha+ut*this.oldAlpha);var Ht=Math.clamp(n.wave_r,0,1),Jt=Math.clamp(n.wave_g,0,1),Zt=Math.clamp(n.wave_b,0,1);if(n.wave_brighten!==0){var St=Math.max(Ht,Jt,Zt);St>.01&&(Ht/=St,Jt/=St,Zt/=St)}if(this.color=[Ht,Jt,Zt,o],this.oldNumVert>0)if(E===7){for(var re=(this.oldNumVert-1)/(this.numVert*2),xt=0;xt<this.numVert;xt++){var ae=xt*re,yt=Math.floor(ae),zt=ae-yt,ce=this.oldPositions[yt*3+0]*(1-zt)+this.oldPositions[(yt+1)*3+0]*zt,Ae=this.oldPositions[yt*3+1]*(1-zt)+this.oldPositions[(yt+1)*3+1]*zt;this.positions[xt*3+0]=this.positions[xt*3+0]*nt+ce*ut,this.positions[xt*3+1]=this.positions[xt*3+1]*nt+Ae*ut,this.positions[xt*3+2]=0}for(var pt=0;pt<this.numVert;pt++){var he=(pt+this.numVert)*re,wt=Math.floor(he),Ot=he-wt,ve=this.oldPositions[wt*3+0]*(1-Ot)+this.oldPositions[(wt+1)*3+0]*Ot,me=this.oldPositions[wt*3+1]*(1-Ot)+this.oldPositions[(wt+1)*3+1]*Ot;this.positions2[pt*3+0]=this.positions2[pt*3+0]*nt+ve*ut,this.positions2[pt*3+1]=this.positions2[pt*3+1]*nt+me*ut,this.positions2[pt*3+2]=0}}else if(v===7){for(var Bt=this.numVert/2,ne=(this.oldNumVert-1)/Bt,Pt=0;Pt<Bt;Pt++){var oe=Pt*ne,Dt=Math.floor(oe),Nt=oe-Dt,de=this.oldPositions[Dt*3+0]*(1-Nt)+this.oldPositions[(Dt+1)*3+0]*Nt,Te=this.oldPositions[Dt*3+1]*(1-Nt)+this.oldPositions[(Dt+1)*3+1]*Nt;this.positions[Pt*3+0]=this.positions[Pt*3+0]*nt+de*ut,this.positions[Pt*3+1]=this.positions[Pt*3+1]*nt+Te*ut,this.positions[Pt*3+2]=0}for(var _t=0;_t<Bt;_t++){var le=_t*ne,Ct=Math.floor(le),Ft=le-Ct,Ee=this.oldPositions2[Ct*3+0]*(1-Ft)+this.oldPositions2[(Ct+1)*3+0]*Ft,be=this.oldPositions2[Ct*3+1]*(1-Ft)+this.oldPositions2[(Ct+1)*3+1]*Ft;this.positions2[_t*3+0]=this.positions[(_t+Bt)*3+0]*nt+Ee*ut,this.positions2[_t*3+1]=this.positions[(_t+Bt)*3+1]*nt+be*ut,this.positions2[_t*3+2]=0}}else for(var xe=(this.oldNumVert-1)/this.numVert,Rt=0;Rt<this.numVert;Rt++){var ue=Rt*xe,qt=Math.floor(ue),Qt=ue-qt,pe=this.oldPositions[qt*3+0]*(1-Qt)+this.oldPositions[(qt+1)*3+0]*Qt,Pe=this.oldPositions[qt*3+1]*(1-Qt)+this.oldPositions[(qt+1)*3+1]*Qt;this.positions[Rt*3+0]=this.positions[Rt*3+0]*nt+pe*ut,this.positions[Rt*3+1]=this.positions[Rt*3+1]*nt+Pe*ut,this.positions[Rt*3+2]=0}for(var Wt=0;Wt<this.numVert;Wt++)this.positions[Wt*3+1]=-this.positions[Wt*3+1];if(this.smoothedNumVert=this.numVert*2-1,_.default.smoothWave(this.positions,this.smoothedPositions,this.numVert),E===7||v===7){for(var kt=0;kt<this.numVert;kt++)this.positions2[kt*3+1]=-this.positions2[kt*3+1];_.default.smoothWave(this.positions2,this.smoothedPositions2,this.numVert)}return!0}return!1}},{key:"drawBasicWaveform",value:function(i,s,a,l,n){if(this.generateWaveform(i,s,a,l,n)){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color);var o=1;(n.wave_thick!==0||n.wave_dots!==0)&&(o=4),n.additivewave!==0?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);for(var r=n.wave_dots!==0?this.gl.POINTS:this.gl.LINE_STRIP,d=0;d<o;d++){var P=2;d===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):d===1?this.gl.uniform2fv(this.thickOffsetLoc,[P/this.texsizeX,0]):d===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,P/this.texsizeY]):d===3&&this.gl.uniform2fv(this.thickOffsetLoc,[P/this.texsizeX,P/this.texsizeY]),this.gl.drawArrays(r,0,this.smoothedNumVert)}var E=Math.floor(n.wave_mode)%8;if(E===7){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions2,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc);for(var v=0;v<o;v++){var b=2;v===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):v===1?this.gl.uniform2fv(this.thickOffsetLoc,[b/this.texsizeX,0]):v===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,b/this.texsizeY]):v===3&&this.gl.uniform2fv(this.thickOffsetLoc,[b/this.texsizeX,b/this.texsizeY]),this.gl.drawArrays(r,0,this.smoothedNumVert)}}}}}],[{key:"processWaveform",value:function(i,s){var a=[],l=s.wave_scale/128,n=s.wave_smoothing,o=l*(1-n);a.push(i[0]*l);for(var r=1;r<i.length;r++)a.push(i[r]*o+a[r-1]*n);return a}}]),e})()}),"./src/rendering/waves/customWaveform.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return e});var x=c("./src/utils.js"),_=c("./src/rendering/shaders/shaderUtils.js"),p=c("./src/rendering/waves/waveUtils.js");function T(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function u(t,i){for(var s=0;s<i.length;s++){var a=i[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function h(t,i,s){return i&&u(t.prototype,i),s&&u(t,s),t}var e=(function(){function t(i,s,a){T(this,t),this.index=i,this.gl=s;var l=512;this.pointsData=[new Float32Array(l),new Float32Array(l)],this.positions=new Float32Array(l*3),this.colors=new Float32Array(l*4),this.smoothedPositions=new Float32Array((l*2-1)*3),this.smoothedColors=new Float32Array((l*2-1)*4),this.texsizeX=a.texsizeX,this.texsizeY=a.texsizeY,this.mesh_width=a.mesh_width,this.mesh_height=a.mesh_height,this.aspectx=a.aspectx,this.aspecty=a.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=_.default.getFragmentFloatPrecision(this.gl),this.createShader()}return h(t,[{key:"updateGlobals",value:function(s){this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}},{key:"createShader",value:function(){this.shaderProgram=this.gl.createProgram();var s=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(s,`#version 300 es
                                      uniform float uSize;
                                      uniform vec2 thickOffset;
                                      in vec3 aPos;
                                      in vec4 aColor;
                                      out vec4 vColor;
                                      void main(void) {
                                        vColor = aColor;
                                        gl_PointSize = uSize;
                                        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);
                                      }`),this.gl.compileShader(s);var a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`#version 300 es
                                      precision `.concat(this.floatPrecision,` float;
                                      precision highp int;
                                      precision mediump sampler2D;
                                      in vec4 vColor;
                                      out vec4 fragColor;
                                      void main(void) {
                                        fragColor = vColor;
                                      }`)),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,s),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.sizeLoc=this.gl.getUniformLocation(this.shaderProgram,"uSize"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}},{key:"generateWaveform",value:function(s,a,l,n,o,r,d,P){if(d.baseVals.enabled!==0&&s.length>0){var E=Object.assign({},r.mdVSWaves[this.index],r.mdVSFrameMapWaves[this.index],r.mdVSQAfterFrame,r.mdVSTWaveInits[this.index],o),v=d.frame_eqs(E),b=512;Object.prototype.hasOwnProperty.call(v,"samples")?this.samples=v.samples:this.samples=b,this.samples>b&&(this.samples=b),this.samples=Math.floor(this.samples);var U=Math.floor(v.sep),D=v.scaling,C=v.spectrum,w=v.smoothing,L=v.usedots,A=v.r,f=v.g,g=v.b,m=v.a,B=r.mdVS.wave_scale;if(this.samples-=U,this.samples>=2||L!==0&&this.samples>=1){var R=C!==0,q=(R?.15:.004)*D*B,y=R?l:s,I=R?n:a,F=R?0:Math.floor((b-this.samples)/2-U/2),W=R?0:Math.floor((b-this.samples)/2+U/2),H=R?(b-U)/this.samples:1,N=Math.pow(w*.98,.5),k=1-N;this.pointsData[0][0]=y[F],this.pointsData[1][0]=I[W];for(var G=1;G<this.samples;G++){var it=y[Math.floor(G*H+F)],Z=I[Math.floor(G*H+W)];this.pointsData[0][G]=it*k+this.pointsData[0][G-1]*N,this.pointsData[1][G]=Z*k+this.pointsData[1][G-1]*N}for(var Q=this.samples-2;Q>=0;Q--)this.pointsData[0][Q]=this.pointsData[0][Q]*k+this.pointsData[0][Q+1]*N,this.pointsData[1][Q]=this.pointsData[1][Q]*k+this.pointsData[1][Q+1]*N;for(var K=0;K<this.samples;K++)this.pointsData[0][K]*=q,this.pointsData[1][K]*=q;for(var X=0;X<this.samples;X++){var O=this.pointsData[0][X],J=this.pointsData[1][X];v.sample=X/(this.samples-1),v.value1=O,v.value2=J,v.x=.5+O,v.y=.5+J,v.r=A,v.g=f,v.b=g,v.a=m,d.point_eqs!==""&&(v=d.point_eqs(v));var st=(v.x*2-1)*this.invAspectx,et=(v.y*-2+1)*this.invAspecty,Y=v.r,V=v.g,at=v.b,ft=v.a;this.positions[X*3+0]=st,this.positions[X*3+1]=et,this.positions[X*3+2]=0,this.colors[X*4+0]=Y,this.colors[X*4+1]=V,this.colors[X*4+2]=at,this.colors[X*4+3]=ft*P}var tt=r.mdVSUserKeysWaves[this.index],ot=x.default.pick(v,tt);return r.mdVSFrameMapWaves[this.index]=ot,this.mdVSWaveFrame=v,L===0&&p.default.smoothWaveAndColor(this.positions,this.colors,this.smoothedPositions,this.smoothedColors,this.samples),!0}}return!1}},{key:"drawCustomWaveform",value:function(s,a,l,n,o,r,d,P){if(P&&this.generateWaveform(a,l,n,o,r,d,P,s)){this.gl.useProgram(this.shaderProgram);var E=this.mdVSWaveFrame.usedots!==0,v=this.mdVSWaveFrame.thick!==0,b=this.mdVSWaveFrame.additive!==0,U,D,C;E?(U=this.positions,D=this.colors,C=this.samples):(U=this.smoothedPositions,D=this.smoothedColors,C=this.samples*2-1),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,U,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,D,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation);var w=1;E?v?this.gl.uniform1f(this.sizeLoc,2+(this.texsizeX>=1024?1:0)):this.gl.uniform1f(this.sizeLoc,1+(this.texsizeX>=1024?1:0)):(this.gl.uniform1f(this.sizeLoc,1),v&&(w=4)),b?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);for(var L=E?this.gl.POINTS:this.gl.LINE_STRIP,A=0;A<w;A++){var f=2;A===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):A===1?this.gl.uniform2fv(this.thickOffsetLoc,[f/this.texsizeX,0]):A===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,f/this.texsizeY]):A===3&&this.gl.uniform2fv(this.thickOffsetLoc,[f/this.texsizeX,f/this.texsizeY]),this.gl.drawArrays(L,0,C)}}}}]),t})()}),"./src/rendering/waves/waveUtils.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return T});function x(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}function _(u,h){for(var e=0;e<h.length;e++){var t=h[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(u,t.key,t)}}function p(u,h,e){return h&&_(u.prototype,h),e&&_(u,e),u}var T=(function(){function u(){x(this,u)}return p(u,null,[{key:"smoothWave",value:function(e,t,i){for(var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=-.15,l=1.15,n=1.15,o=-.15,r=1/(a+l+n+o),d=0,P=0,E,v=1,b=0;b<i-1;b++){E=v,v=Math.min(i-1,b+2);for(var U=0;U<3;U++)t[d*3+U]=e[b*3+U];if(s)for(var D=0;D<3;D++)t[(d+1)*3+D]=(a*e[P*3+D]+l*e[b*3+D]+n*e[E*3+D]+o*e[v*3+D])*r;else{for(var C=0;C<2;C++)t[(d+1)*3+C]=(a*e[P*3+C]+l*e[b*3+C]+n*e[E*3+C]+o*e[v*3+C])*r;t[(d+1)*3+2]=0}P=b,d+=2}for(var w=0;w<3;w++)t[d*3+w]=e[(i-1)*3+w]}},{key:"smoothWaveAndColor",value:function(e,t,i,s,a){for(var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,n=-.15,o=1.15,r=1.15,d=-.15,P=1/(n+o+r+d),E=0,v=0,b,U=1,D=0;D<a-1;D++){b=U,U=Math.min(a-1,D+2);for(var C=0;C<3;C++)i[E*3+C]=e[D*3+C];if(l)for(var w=0;w<3;w++)i[(E+1)*3+w]=(n*e[v*3+w]+o*e[D*3+w]+r*e[b*3+w]+d*e[U*3+w])*P;else{for(var L=0;L<2;L++)i[(E+1)*3+L]=(n*e[v*3+L]+o*e[D*3+L]+r*e[b*3+L]+d*e[U*3+L])*P;i[(E+1)*3+2]=0}for(var A=0;A<4;A++)s[E*4+A]=t[D*4+A],s[(E+1)*4+A]=t[D*4+A];v=D,E+=2}for(var f=0;f<3;f++)i[E*3+f]=e[(a-1)*3+f];for(var g=0;g<4;g++)s[E*4+g]=t[(a-1)*4+g]}}]),u})()}),"./src/utils.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return t});function x(i){return T(i)||p(i)||_()}function _(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function p(i){if(Symbol.iterator in Object(i)||Object.prototype.toString.call(i)==="[object Arguments]")return Array.from(i)}function T(i){if(Array.isArray(i)){for(var s=0,a=new Array(i.length);s<i.length;s++)a[s]=i[s];return a}}function u(i,s){if(!(i instanceof s))throw new TypeError("Cannot call a class as a function")}function h(i,s){for(var a=0;a<s.length;a++){var l=s[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(i,l.key,l)}}function e(i,s,a){return s&&h(i.prototype,s),a&&h(i,a),i}var t=(function(){function i(){u(this,i)}return e(i,null,[{key:"atan2",value:function(a,l){var n=Math.atan2(a,l);return n<0&&(n+=2*Math.PI),n}},{key:"cloneVars",value:function(a){return Object.assign({},a)}},{key:"range",value:function(a,l){return l===void 0?x(Array(a).keys()):Array.from({length:l-a},function(n,o){return o+a})}},{key:"pick",value:function(a,l){for(var n={},o=0;o<l.length;o++){var r=l[o];n[r]=a[r]}return n}},{key:"omit",value:function(a,l){for(var n=Object.assign({},a),o=0;o<l.length;o++){var r=l[o];delete n[r]}return n}}]),i})()}),"./src/visualizer.js":(function(S,M,c){"use strict";c.r(M),c.d(M,"default",function(){return h});var x=c("./src/audio/audioProcessor.js"),_=c("./src/rendering/renderer.js");function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e,t,i){return t&&T(e.prototype,t),i&&T(e,i),e}var h=(function(){function e(t,i,s){p(this,e),this.audio=new x.default(t);var a=i.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1});this.baseValsDefaults={decay:.98,gammaadj:2,echo_zoom:2,echo_alpha:0,echo_orient:0,red_blue:0,brighten:0,darken:0,wrap:1,darken_center:0,solarize:0,invert:0,fshader:0,b1n:0,b2n:0,b3n:0,b1x:1,b2x:1,b3x:1,b1ed:.25,wave_mode:0,additivewave:0,wave_dots:0,wave_thick:0,wave_a:.8,wave_scale:1,wave_smoothing:.75,wave_mystery:0,modwavealphabyvolume:0,modwavealphastart:.75,modwavealphaend:.95,wave_r:1,wave_g:1,wave_b:1,wave_x:.5,wave_y:.5,wave_brighten:1,mv_x:12,mv_y:9,mv_dx:0,mv_dy:0,mv_l:.9,mv_r:1,mv_g:1,mv_b:1,mv_a:1,warpanimspeed:1,warpscale:1,zoomexp:1,zoom:1,rot:0,cx:.5,cy:.5,dx:0,dy:0,warp:1,sx:1,sy:1,ob_size:.01,ob_r:0,ob_g:0,ob_b:0,ob_a:0,ib_size:.01,ib_r:.25,ib_g:.25,ib_b:.25,ib_a:0},this.shapeBaseValsDefaults={enabled:0,sides:4,additive:0,thickoutline:0,textured:0,num_inst:1,tex_zoom:1,tex_ang:0,x:.5,y:.5,rad:.1,ang:0,r:1,g:0,b:0,a:1,r2:0,g2:1,b2:0,a2:0,border_r:1,border_g:1,border_b:1,border_a:.1},this.waveBaseValsDefaults={enabled:0,samples:512,sep:0,scaling:1,smoothing:.5,r:1,g:1,b:1,a:1,spectrum:0,usedots:0,thick:0,additive:0},this.renderer=new _.default(a,this.audio,s)}return u(e,[{key:"connectAudio",value:function(i){this.audioNode=i,this.audio.connectAudio(i)}},{key:"disconnectAudio",value:function(i){this.audio.disconnectAudio(i)}},{key:"loadPreset",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Object.assign({},i);a.baseVals=Object.assign({},this.baseValsDefaults,a.baseVals);for(var l=0;l<a.shapes.length;l++)a.shapes[l].baseVals=Object.assign({},this.shapeBaseValsDefaults,a.shapes[l].baseVals);for(var n=0;n<a.waves.length;n++)a.waves[n].baseVals=Object.assign({},this.waveBaseValsDefaults,a.waves[n].baseVals);if(typeof a.init_eqs!="function"){a.init_eqs=new Function("a","".concat(a.init_eqs_str," return a;")),a.frame_eqs=new Function("a","".concat(a.frame_eqs_str," return a;")),a.pixel_eqs_str&&a.pixel_eqs_str!==""?a.pixel_eqs=new Function("a","".concat(a.pixel_eqs_str," return a;")):a.pixel_eqs="";for(var o=0;o<a.shapes.length;o++)a.shapes[o].baseVals.enabled!==0&&(a.shapes[o]=Object.assign({},a.shapes[o],{init_eqs:new Function("a","".concat(a.shapes[o].init_eqs_str," return a;")),frame_eqs:new Function("a","".concat(a.shapes[o].frame_eqs_str," return a;"))}));for(var r=0;r<a.waves.length;r++)if(a.waves[r].baseVals.enabled!==0){var d={init_eqs:new Function("a","".concat(a.waves[r].init_eqs_str," return a;")),frame_eqs:new Function("a","".concat(a.waves[r].frame_eqs_str," return a;"))};a.waves[r].point_eqs_str&&a.waves[r].point_eqs_str!==""?d.point_eqs=new Function("a","".concat(a.waves[r].point_eqs_str," return a;")):d.point_eqs="",a.waves[r]=Object.assign({},a.waves[r],d)}}this.renderer.loadPreset(a,s)}},{key:"loadExtraImages",value:function(i){this.renderer.loadExtraImages(i)}},{key:"setRendererSize",value:function(i,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.renderer.setRendererSize(i,s,a)}},{key:"setInternalMeshSize",value:function(i,s){this.renderer.setInternalMeshSize(i,s)}},{key:"setOutputAA",value:function(i){this.renderer.setOutputAA(i)}},{key:"render",value:function(i){this.renderer.render(i)}},{key:"launchSongTitleAnim",value:function(i){this.renderer.launchSongTitleAnim(i)}},{key:"toDataURL",value:function(){return this.renderer.toDataURL()}},{key:"warpBufferToDataURL",value:function(){return this.renderer.warpBufferToDataURL()}}]),e})()})})})});var $t=Be(ge()),Ce=$t.default??$t;export{Ce as default};
